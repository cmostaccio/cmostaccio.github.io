function EventListener(){this.events=[]}function UndoBlock(){}function UndoMove(a,b,c,d,e){this.objectID=a,this.fromX=b,this.fromY=c,this.toX=d,this.toY=e}function UndoCreate(a){this.objectID=a}function UndoHighlight(a,b){this.objectID=a,this.highlightValue=b}function UndoSetHeight(a,b){this.objectID=a,this.height=b}function UndoSetWidth(a,b){this.objectID=a,this.width=b}function UndoSetNumElements(a,b){if(this.objectID=a.objectID,this.sizeBeforeChange=a.getNumElements(),this.sizeAfterChange=b,this.sizeBeforeChange>this.sizeAfterChange){this.labels=new Array(this.sizeBeforeChange-this.sizeAfterChange),this.colors=new Array(this.sizeBeforeChange-this.sizeAfterChange);for(var c=0;c<this.sizeBeforeChange-this.sizeAfterChange;c++)this.labels[c]=a.getText(c+this.sizeAfterChange),this.colors[c]=a.getTextColor(c+this.sizeAfterChange)}}function UndoSetAlpha(a,b){this.objectID=a,this.alphaVal=b}function UndoSetNull(a,b){this.objectID=a,this.nullVal=b}function UndoSetForegroundColor(a,b){this.objectID=a,this.color=b}function UndoSetBackgroundColor(a,b){this.objectID=a,this.color=b}function UndoSetText(a,b,c){this.objectID=a,this.newText=b,this.labelIndex=c}function UndoSetTextColor(a,b,c){this.objectID=a,this.color=b,this.index=c}function UndoHighlightEdge(a,b,c){this.fromID=a,this.toID=b,this.highlightValue=c}function UndoSetEdgeColor(a,b,c){this.fromID=a,this.toID=b,this.color=c}function UndoSetEdgeAlpha(a,b,c){this.fromID=a,this.toID=b,this.alpha=c}function UndoSetPosition(a,b,c){this.objectID=a,this.x=b,this.y=c}function AnimatedObject(){this.init()}function AnimatedLabel(a,b,c,d){this.centering=c,this.label=b,this.highlighted=!1,this.objectID=a,this.alpha=1,this.addedToScene=!0,this.labelColor="#000000",this.textWidth=0,void 0!=d&&(this.textWidth=d)}function UndoDeleteLabel(a,b,c,d,e,f,g){this.objectID=a,this.posX=c,this.posY=d,this.nodeLabel=b,this.labCentered=e,this.labelColor=f,this.layer=g}function UndoDeleteCircle(a,b,c,d,e,f,g){this.objectID=a,this.posX=c,this.posY=d,this.nodeLabel=b,this.fgColor=e,this.bgColor=f,this.layer=g}function UndoDeleteRectangle(a,b,c,d,e,f,g,h,i,j,k,l){this.objectID=a,this.posX=c,this.posY=d,this.width=e,this.height=f,this.xJustify=g,this.yJustify=h,this.backgroundColor=i,this.foregroundColor=j,this.nodeLabel=b,this.layer=l,this.highlighted=k}function AnimatedLinkedList(a,b,c,d,e,f,g,h,i,j){this.init(a,b,c,d,e,f,g,h,i,j)}function UndoDeleteLinkedList(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){this.objectID=a,this.posX=d,this.posY=e,this.width=f,this.height=g,this.backgroundColor=l,this.foregroundColor=m,this.labels=c,this.linkPercent=h,this.verticalOrentation=j,this.linkAtEnd=i,this.labelColors=k,this.layer=n,this.numLabels=b,this.nullPointer=o}function UndoDeleteHighlightCircle(a,b,c,d,e,f,g){this.objectID=a,this.x=b,this.y=c,this.color=d,this.r=e,this.layer=f,this.alpha=g}function Line(a,b,c,d,e,f,g){this.arrowHeight=8,this.arrowWidth=4,this.Node1=a,this.Node2=b,this.Dirty=!1,this.directed=e,this.edgeColor=c,this.edgeLabel=f,this.highlighted=!1,this.addedToScene=!0,this.anchorPoint=g,this.highlightDiff=0,this.curve=d,this.alpha=1,this.color=function(){return this.edgeColor},this.setColor=function(a){this.edgeColor=a,Dirty=!0},this.setHighlight=function(a){this.highlighted=a},this.pulseHighlight=function(a){if(this.highlighted){var b=a/14,c=Math.abs(b%(2*LINE_range-2)-LINE_range+1);this.highlightDiff=c+LINE_minHeightDiff,Dirty=!0}},this.hasNode=function(a){return this.Node1==a||this.Node2==a},this.createUndoDisconnect=function(){return new UndoConnect(this.Node1.objectID,this.Node2.objectID,!0,this.edgeColor,this.directed,this.curve,this.edgeLabel,this.anchorPoint)},this.sign=function(a){return a>0?1:-1},this.drawArrow=function(a,b,c){c.strokeStyle=b,c.fillStyle=b,c.lineWidth=a;var d=this.Node1.getTailPointerAttachPos(this.Node2.x,this.Node2.y,this.anchorPoint),e=this.Node2.getHeadPointerAttachPos(this.Node1.x,this.Node1.y),d=this.Node1.getTailPointerAttachPos(this.Node2.x,this.Node2.y,this.anchorPoint),e=this.Node2.getHeadPointerAttachPos(this.Node1.x,this.Node1.y),f=e[0]-d[0],g=e[1]-d[1],h=f/2+d[0],i=g/2+d[1],j=h-g*this.curve,k=i+f*this.curve;c.beginPath(),c.moveTo(d[0],d[1]),c.quadraticCurveTo(j,k,e[0],e[1]),c.stroke();var l=.25*d[0]+.5*j+.25*e[0],m=.25*d[1]+.5*k+.25*e[1],n=Math.sqrt(g*g+f*f);if(0!=n&&(l+=-g*this.sign(this.curve)/n*10,m+=f*this.sign(this.curve)/n*10),c.textAlign="center",c.font="10px sans-serif",c.textBaseline="middle",c.fillText(this.edgeLabel,l,m),this.directed){var o=j-e[0],p=k-e[1],q=Math.sqrt(o*o+p*p);q>0&&(o/=q,p/=q,c.beginPath(),c.moveTo(e[0],e[1]),c.lineTo(e[0]+o*this.arrowHeight-p*this.arrowWidth,e[1]+p*this.arrowHeight+o*this.arrowWidth),c.lineTo(e[0]+o*this.arrowHeight+p*this.arrowWidth,e[1]+p*this.arrowHeight-o*this.arrowWidth),c.lineTo(e[0],e[1]),c.closePath(),c.stroke(),c.fill())}},this.draw=function(a){this.addedToScene&&(a.globalAlpha=this.alpha,this.highlighted&&this.drawArrow(this.highlightDiff,"#FF0000",a),this.drawArrow(1,this.edgeColor,a))}}function UndoConnect(a,b,c,d,e,f,g,h){this.fromID=a,this.toID=b,this.connect=c,this.color=d,this.directed=e,this.curve=f,this.edgeLabel=g,this.anchorPoint=h}function ObjectManager(){this.Nodes=[],this.Edges=[],this.BackEdges=[],this.activeLayers=[],this.activeLayers[0]=!0,this.ctx=document.getElementById("canvas").getContext("2d"),this.framenum=0,this.width=0,this.height=0,this.statusReport=new AnimatedLabel(-1,"XXX",!1,30),this.statusReport.x=30,this.draw=function(){this.framenum++,this.framenum>1e3&&(this.framenum=0),this.ctx.clearRect(0,0,this.width,this.height),this.statusReport.y=this.height-15;var a,b;for(a=0;a<this.Nodes.length;a++)null==this.Nodes[a]||this.Nodes[a].highlighted||!this.Nodes[a].addedToScene||this.Nodes[a].alwaysOnTop||this.Nodes[a].draw(this.ctx);for(a=0;a<this.Nodes.length;a++)null!=this.Nodes[a]&&this.Nodes[a].highlighted&&!this.Nodes[a].alwaysOnTop&&this.Nodes[a].addedToScene&&(this.Nodes[a].pulseHighlight(this.framenum),this.Nodes[a].draw(this.ctx));for(a=0;a<this.Nodes.length;a++)null!=this.Nodes[a]&&this.Nodes[a].alwaysOnTop&&this.Nodes[a].addedToScene&&(this.Nodes[a].pulseHighlight(this.framenum),this.Nodes[a].draw(this.ctx));for(a=0;a<this.Edges.length;a++)if(null!=this.Edges[a])for(b=0;b<this.Edges[a].length;b++)this.Edges[a][b].addedToScene&&(this.Edges[a][b].pulseHighlight(this.framenum),this.Edges[a][b].draw(this.ctx));this.statusReport.draw(this.ctx)},this.update=function(){},this.setLayers=function(a,b){for(var c=0;c<b.length;c++)this.activeLayers[b[c]]=a;this.resetLayers()},this.addHighlightCircleObject=function(a,b,c){if(null!=this.Nodes[a]&&void 0!=this.Nodes[a])throw"addHighlightCircleObject:Object with same ID ("+String(a)+") already Exists!";var d=new HighlightCircle(a,b,c);this.Nodes[a]=d},this.setEdgeAlpha=function(a,b,c){var d=1;if(null!=this.Edges[a]&&void 0!=this.Edges[a])for(var e=this.Edges[a].length,f=e-1;f>=0;f--)null!=this.Edges[a][f]&&void 0!=this.Edges[a][f]&&this.Edges[a][f].Node2==this.Nodes[b]&&(d=this.Edges[a][f].alpha,this.Edges[a][f].alpha=c);return d},this.setAlpha=function(a,b){null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].setAlpha(b)},this.getAlpha=function(a){return null!=this.Nodes[a]&&void 0!=this.Nodes[a]?this.Nodes[a].getAlpha():-1},this.getTextColor=function(a,b){return null!=this.Nodes[a]&&void 0!=this.Nodes[a]?this.Nodes[a].getTextColor(b):"#000000"},this.setTextColor=function(a,b,c){null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].setTextColor(b,c)},this.setAllLayers=function(a){this.activeLayers=[];for(var b=0;b<a.length;b++)this.activeLayers[a[b]]=!0;this.resetLayers()},this.resetLayers=function(){var a;for(a=0;a<this.Nodes.length;a++)null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&(this.Nodes[a].addedToScene=1==this.activeLayers[this.Nodes[a].layer]);for(a=this.Edges.length-1;a>=0;a--)if(null!=this.Edges[a]&&void 0!=this.Edges[a])for(var b=0;b<this.Edges[a].length;b++)null!=this.Edges[a][b]&&void 0!=this.Edges[a][b]&&(this.Edges[a][b].addedToScene=1==this.activeLayers[this.Edges[a][b].Node1.layer]&&1==this.activeLayers[this.Edges[a][b].Node2.layer])},this.setLayer=function(a,b){if(null!=this.Nodes[a]&&void 0!=this.Nodes[a]){if(this.Nodes[a].layer=b,this.activeLayers[b]?this.Nodes[a].addedToScene=!0:this.Nodes[a].addedToScene=!1,null!=this.Edges[a]&&void 0!=this.Edges[a])for(var c=0;c<this.Edges[a].length;c++){var d=this.Edges[a][c];null!=d&&void 0!=d&&(d.addedToScene=d.Node1.addedToScene&&d.Node2.addedToScene)}if(null!=this.BackEdges[a]&&void 0!=this.BackEdges[a])for(var c=0;c<this.BackEdges[a].length;c++){var d=this.BackEdges[a][c];null!=d&&void 0!=d&&(d.addedToScene=d.Node1.addedToScene&&d.Node2.addedToScene)}}},this.clearAllObjects=function(){this.Nodes=[],this.Edges=[],this.BackEdges=[]},this.setForegroundColor=function(a,b){null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].setForegroundColor(b)},this.setBackgroundColor=function(a,b){null!=this.Nodes[a]&&this.Nodes[a].setBackgroundColor(b)},this.setHighlight=function(a,b){null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].setHighlight(b)},this.getHighlight=function(a){return null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].getHighlight()},this.setWidth=function(a,b){null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].setWidth(b)},this.setHeight=function(a,b){null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].setHeight(b)},this.getHeight=function(a){return null==this.Nodes[a]||void 0==this.Nodes[a]?-1:this.Nodes[a].getHeight()},this.getWidth=function(a){return null==this.Nodes[a]||void 0==this.Nodes[a]?-1:this.Nodes[a].getWidth()},this.backgroundColor=function(a){return null!=this.Nodes[a]?this.Nodes[a].backgroundColor:"#000000"},this.foregroundColor=function(a){return null!=this.Nodes[a]?this.Nodes[a].foregroundColor:"#000000"},this.disconnect=function(a,b){var d,c=null;if(null!=this.Edges[a]){var e=this.Edges[a].length;for(d=e-1;d>=0;d--)if(null!=this.Edges[a][d]&&this.Edges[a][d].Node2==this.Nodes[b]){var f=this.Edges[a][d];c=f.createUndoDisconnect(),this.Edges[a][d]=this.Edges[a][e-1],e-=1,this.Edges[a].pop()}}if(null!=this.BackEdges[b])for(e=this.BackEdges[b].length,d=e-1;d>=0;d--)null!=this.BackEdges[b][d]&&this.BackEdges[b][d].Node1==this.Nodes[a]&&(f=this.BackEdges[b][d],this.BackEdges[b][d]=this.BackEdges[b][e-1],e-=1,this.BackEdges[b].pop());return c},this.deleteIncident=function(a){var b=[];if(null!=this.Edges[a]){for(var c=this.Edges[a].length,d=c-1;d>=0;d--){var e=this.Edges[a][d],f=e.Node2.identifier();b.push(e.createUndoDisconnect());for(var g=this.BackEdges[f].length,h=g-1;h>=0;h--)this.BackEdges[f][h]==e&&(this.BackEdges[f][h]=this.BackEdges[f][g-1],g-=1,this.BackEdges[f].pop())}this.Edges[a]=null}if(null!=this.BackEdges[a]){for(c=this.BackEdges[a].length,d=c-1;d>=0;d--){e=this.BackEdges[a][d];var i=e.Node1.identifier();for(b.push(e.createUndoDisconnect()),g=this.Edges[i].length,h=g-1;h>=0;h--)this.Edges[i][h]==e&&(this.Edges[i][h]=this.Edges[i][g-1],g-=1,this.Edges[i].pop())}this.BackEdges[a]=null}return b},this.removeObject=function(a){this.Nodes[a];a==this.Nodes.length-1?this.Nodes.pop():this.Nodes[a]=null},this.getObject=function(a){if(null==this.Nodes[a]||void 0==this.Nodes[a])throw"getObject:Object with ID ("+String(a)+") does not exist";return this.Nodes[a]},this.addCircleObject=function(a,b){if(null!=this.Nodes[a]&&void 0!=this.Nodes[a])throw"addCircleObject:Object with same ID ("+String(a)+") already Exists!";var c=new AnimatedCircle(a,b);this.Nodes[a]=c},this.getNodeX=function(a){if(null==this.Nodes[a]||void 0==this.Nodes[a])throw"getting x position of an object that does not exit";return this.Nodes[a].x},this.getTextWidth=function(a){this.ctx.font="10px sans-serif",void 0==a&&(w=3);var b=a.split("\n"),c=0;if(1==b.length)c=this.ctx.measureText(a).width;else for(var d=0;d<b.length;d++)c=Math.max(c,this.ctx.measureText(b[d]).width);return c},this.setText=function(a,b,c){null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].setText(b,c,this.getTextWidth(b))},this.getText=function(a,b){if(null==this.Nodes[a]||void 0==this.Nodes[a])throw"getting text of an object that does not exit";return this.Nodes[a].getText(b)},this.getNodeY=function(a){if(null==this.Nodes[a]||void 0==this.Nodes[a])throw"getting y position of an object that does not exit";return this.Nodes[a].y},this.connectEdge=function(a,b,c,d,e,f,g){var h=this.Nodes[a],i=this.Nodes[b];if(null==h||null==i)throw"Tried to connect two nodes, one didn't exist!";var j=new Line(h,i,c,d,e,f,g);null!=this.Edges[a]&&void 0!=this.Edges[a]||(this.Edges[a]=[]),null!=this.BackEdges[b]&&void 0!=this.BackEdges[b]||(this.BackEdges[b]=[]),j.addedToScene=h.addedToScene&&i.addedToScene,this.Edges[a].push(j),this.BackEdges[b].push(j)},this.setNull=function(a,b){null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].setNull(b)},this.getNull=function(a){return null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&this.Nodes[a].getNull()},this.setEdgeColor=function(a,b,c){var d="#000000";if(null!=this.Edges[a]&&void 0!=this.Edges[a])for(var e=this.Edges[a].length,f=e-1;f>=0;f--)null!=this.Edges[a][f]&&void 0!=this.Edges[a][f]&&this.Edges[a][f].Node2==this.Nodes[b]&&(d=this.Edges[a][f].color(),this.Edges[a][f].setColor(c));return d},this.alignTop=function(a,b){if(null==this.Nodes[a]||void 0==this.Nodes[a]||null==this.Nodes[b]||void 0==this.Nodes[b])throw"Tring to align two nodes, one doesn't exist: "+String(a)+","+String(b);this.Nodes[a].alignTop(this.Nodes[b])},this.alignLeft=function(a,b){if(null==this.Nodes[a]||void 0==this.Nodes[a]||null==this.Nodes[b]||void 0==this.Nodes[b])throw"Tring to align two nodes, one doesn't exist: "+String(a)+","+String(b);this.Nodes[a].alignLeft(this.Nodes[b])},this.alignRight=function(a,b){if(null==this.Nodes[a]||void 0==this.Nodes[a]||null==this.Nodes[b]||void 0==this.Nodes[b])throw"Tring to align two nodes, one doesn't exist: "+String(a)+","+String(b);this.Nodes[a].alignRight(this.Nodes[b])},this.alignBottom=function(a,b){if(null==this.Nodes[a]||void 0==this.Nodes[a]||null==this.Nodes[b]||void 0==this.Nodes[b])throw"Tring to align two nodes, one doesn't exist: "+String(a)+","+String(b);this.Nodes[a].alignBottom(this.Nodes[b])},this.setEdgeHighlight=function(a,b,c){var d=!1;if(null!=this.Edges[a]&&void 0!=this.Edges[a])for(var e=this.Edges[a].length,f=e-1;f>=0;f--)null!=this.Edges[a][f]&&void 0!=this.Edges[a][f]&&this.Edges[a][f].Node2==this.Nodes[b]&&(d=this.Edges[a][f].highlighted,this.Edges[a][f].setHighlight(c));return d},this.addLabelObject=function(a,b,c){if(null!=this.Nodes[a]&&void 0!=this.Nodes[a])throw new Error("addLabelObject: Object Already Exists!");var d=new AnimatedLabel(a,b,c,this.getTextWidth(b));this.Nodes[a]=d},this.addLinkedListObject=function(a,b,c,d,e,f,g,h,i,j){if(null!=this.Nodes[a])throw new Error("addLinkedListObject:Object with same ID already Exists!");var k=new AnimatedLinkedList(a,b,c,d,e,f,g,h,i,j);this.Nodes[a]=k},this.getNumElements=function(a){return this.Nodes[a].getNumElements()},this.setNumElements=function(a,b){this.Nodes[a].setNumElements(b)},this.addBTreeNode=function(a,b,c,d,e,f){if(e=void 0==e?"#FFFFFF":e,f=void 0==f?"#FFFFFF":f,null!=this.Nodes[a]&&void 0!=Nodes[a])throw"addBTreeNode:Object with same ID already Exists!";var g=new AnimatedBTreeNode(a,b,c,d,e,f);this.Nodes[a]=g},this.addRectangleObject=function(a,b,c,d,e,f,g,h){if(null!=this.Nodes[a]||void 0!=this.Nodes[a])throw new Error("addRectangleObject:Object with same ID already Exists!");var i=new AnimatedRectangle(a,b,c,d,e,f,g,h);this.Nodes[a]=i},this.setNodePosition=function(a,b,c){null!=this.Nodes[a]&&void 0!=this.Nodes[a]&&void 0!=b&&void 0!=c&&(this.Nodes[a].x=b,this.Nodes[a].y=c)},this.existsNode=function(a){return null!=this.Nodes[a]&&void 0!=this.Nodes[a]}}function addLabelToAlgorithmBar(a){var b=document.createTextNode(a),c=document.createElement("td");c.appendChild(b);var d=document.getElementById("AlgorithmSpecificControls");return d.appendChild(c),b}function addCheckboxToAlgorithmBar(a){var b=document.createElement("input");b.setAttribute("type","checkbox"),b.setAttribute("value",a);var c=document.createTextNode(a),d=document.createElement("td");d.appendChild(b),d.appendChild(c);var e=document.getElementById("AlgorithmSpecificControls");return e.appendChild(d),b}function addRadioButtonGroupToAlgorithmBar(a,b){for(var c=[],d=document.createElement("table"),e=0;e<a.length;e++){var f=document.createElement("tr"),g=document.createElement("td"),h=document.createElement("input");h.setAttribute("type","radio"),h.setAttribute("name",b),h.setAttribute("value",a[e]),g.appendChild(h),f.appendChild(g);var i=document.createTextNode(" "+a[e]);g.appendChild(i),d.appendChild(f),c.push(h)}var j=document.createElement("td");j.appendChild(d);var k=document.getElementById("AlgorithmSpecificControls");return k.appendChild(j),c}function addControlToAlgorithmBar(a,b){var c=document.createElement("input");c.setAttribute("type",a),c.setAttribute("value",b),c.setAttribute("name",b);var d=document.createElement("td");d.appendChild(c);var e=document.getElementById("AlgorithmSpecificControls");return e.appendChild(d),c}function Algorithm(a){}function controlKey(a){return 8==a||9==a||37==a||38==a||39==a||40==a||46==a}function Graph(a,b,c,d,e){void 0!=a&&this.init(a,b,c,d,e)}function BFS(a){this.init(a)}function init(){var a=initCanvas();currentAlg=new BFS(a,canvas.width,canvas.height)}function DFS(a){this.init(a)}function returnSubmit(a,b,c,d){return void 0!=c&&(a.size=c),function(e){var f=0;if(window.event?f=e.keyCode:e.which&&(f=e.which),13==f)b();else{if(59==f)return!1;if((void 0!=c&&a.value.length>=c||d&&(f<48||f>57))&&!controlKey(f))return!1}}}function animWaiting(){objectManager.statusReport.setText("Animation Paused"),objectManager.statusReport.setForegroundColor("#FF0000")}function animStarted(){objectManager.statusReport.setText("Animation Running"),objectManager.statusReport.setForegroundColor("#009900")}function animEnded(){objectManager.statusReport.setText("Animation Completed"),objectManager.statusReport.setForegroundColor("#000000")}function anumUndoUnavailable(){}function timeout(){timer=setTimeout("timeout()",30),animationManager.update(),objectManager.draw()}function doStep(){animationManager.step()}function doSkip(){animationManager.skipForward()}function doSkipBack(){animationManager.skipBack()}function doStepBack(){animationManager.stepBack()}function doPlayPause(){paused=!paused,animationManager.SetPaused(paused)}function addControl(a,b,c){var d=document.createElement("input");d.setAttribute("type",a),d.setAttribute("value",b);var e=document.createElement("td");e.appendChild(d);var f=document.getElementById(e);return f.appendChild(d),d}function addControlToAnimationBar(a,b,c){void 0==c&&(c="input");var d=document.createElement(c);d.setAttribute("type",a),d.setAttribute("value",b);var e=document.createElement("td");e.appendChild(d);var f=document.getElementById("GeneralAnimationControls");return f.appendChild(e),d}function initCanvas(){canvas=document.getElementById("canvas"),objectManager=new ObjectManager,animationManager=new AnimationManager(objectManager);var a=document.createElement("div");a.setAttribute("display","inline-block"),a.setAttribute("float","left");var b=document.createElement("td"),c=document.getElementById("GeneralAnimationControls"),d=document.createElement("table"),e=document.createElement("tr"),f=document.createElement("td");e.appendChild(f),f.appendChild(a),d.appendChild(e),e=document.createElement("tr"),f=document.createElement("td"),f.align="center";var g=document.createTextNode("Velocidad de animación");e.appendChild(f),f.appendChild(g),d.appendChild(e),b.appendChild(d),c.appendChild(b);var h=ANIMATION_SPEED_DEFAULT;return $(a).slider({animate:!0,value:h,slide:function(a,b){animationManager.SetSpeed(b.value)}}),animationManager.SetSpeed(h),a.setAttribute("style","width:200px"),animationManager.addListener("AnimationStarted",this,animStarted),animationManager.addListener("AnimationEnded",this,animEnded),animationManager.addListener("AnimationWaiting",this,animWaiting),objectManager.width=canvas.width,objectManager.height=canvas.height,animationManager}function AnimationManager(a){this.animatedObjects=a,this.animationPaused=!1,this.awaitingStep=!1,this.currentlyAnimating=!1,this.AnimationSteps=[],this.currentAnimation=0,this.previousAnimationSteps=[],this.currFrame=0,this.animationBlockLength=0,this.currentBlock=null,this.undoStack=[],this.doingUndo=!1,this.undoAnimationStepIndices=[],this.undoAnimationStepIndicesStack=[],this.animationBlockLength=10,this.lerp=function(a,b,c){return(b-a)*c+a},this.SetPaused=function(a){this.animationPaused=a,this.animationPaused||this.step()},this.SetSpeed=function(a){this.animationBlockLength=Math.floor((100-a)/2)},this.parseBool=function(a){var b=a.toUpperCase(),c=!("False"==b||"f"==b||" 0"==b||"0"==b||""==b);return c},this.parseColor=function(a){return"#"==a.charAt(0)?a:"0x"==a.substring(0,2)?"#"+a.substring(2):void 0},this.changeSize=function(){var a=parseInt(widthEntry.value),b=parseInt(heightEntry.value);a>100&&(canvas.width=a,this.animatedObjects.width=a),b>100&&(canvas.height=b,this.animatedObjects.height=b),a.value=canvas.width,heightEntry.value=canvas.height,this.animatedObjects.draw(),this.fireEvent("CanvasSizeChanged",{width:canvas.width,height:canvas.height})},this.startNextBlock=function(){this.awaitingStep=!1,this.currentBlock=[];var a=[];if(this.currentAnimation==this.AnimationSteps.length)return this.currentlyAnimating=!1,this.awaitingStep=!1,this.fireEvent("AnimationEnded","NoData"),clearTimeout(timer),this.animatedObjects.update(),void this.animatedObjects.draw();this.undoAnimationStepIndices.push(this.currentAnimation);for(var b=!1,c=!1;this.currentAnimation<this.AnimationSteps.length&&!b;){var d=this.AnimationSteps[this.currentAnimation].split("<;>");if("CREATECIRCLE"==d[0].toUpperCase())this.animatedObjects.addCircleObject(parseInt(d[1]),d[2]),d.length>4&&this.animatedObjects.setNodePosition(parseInt(d[1]),parseInt(d[3]),parseInt(d[4])),a.push(new UndoCreate(parseInt(d[1])));else if("CONNECT"==d[0].toUpperCase())d.length>7?this.animatedObjects.connectEdge(parseInt(d[1]),parseInt(d[2]),this.parseColor(d[3]),parseFloat(d[4]),this.parseBool(d[5]),d[6],parseInt(d[7])):d.length>6?this.animatedObjects.connectEdge(parseInt(d[1]),parseInt(d[2]),this.parseColor(d[3]),parseFloat(d[4]),this.parseBool(d[5]),d[6],0):d.length>5?this.animatedObjects.connectEdge(parseInt(d[1]),parseInt(d[2]),this.parseColor(d[3]),parseFloat(d[4]),this.parseBool(d[5]),"",0):d.length>4?this.animatedObjects.connectEdge(parseInt(d[1]),parseInt(d[2]),this.parseColor(d[3]),parseFloat(d[4]),!0,"",0):d.length>3?this.animatedObjects.connectEdge(parseInt(d[1]),parseInt(d[2]),this.parseColor(d[3]),0,!0,"",0):this.animatedObjects.connectEdge(parseInt(d[1]),parseInt(d[2]),"#000000",0,!0,"",0),a.push(new UndoConnect(parseInt(d[1]),parseInt(d[2]),!1));else if("CREATERECTANGLE"==d[0].toUpperCase())9==d.length?this.animatedObjects.addRectangleObject(parseInt(d[1]),d[2],parseInt(d[3]),parseInt(d[4]),d[7],d[8],"#ffffff","#000000"):this.animatedObjects.addRectangleObject(parseInt(d[1]),d[2],parseInt(d[3]),parseInt(d[4]),"center","center","#ffffff","#000000"),d.length>6&&this.animatedObjects.setNodePosition(parseInt(d[1]),parseInt(d[5]),parseInt(d[6])),a.push(new UndoCreate(parseInt(d[1])));else if("MOVE"==d[0].toUpperCase()){var e=parseInt(d[1]),f=new SingleAnimation(e,this.animatedObjects.getNodeX(e),this.animatedObjects.getNodeY(e),parseInt(d[2]),parseInt(d[3]));this.currentBlock.push(f),a.push(new UndoMove(f.objectID,f.toX,f.toY,f.fromX,f.fromY)),c=!0}else if("STEP"==d[0].toUpperCase())b=!0;else if("SETFOREGROUNDCOLOR"==d[0].toUpperCase()){var g=parseInt(d[1]),h=this.animatedObjects.foregroundColor(g);this.animatedObjects.setForegroundColor(g,this.parseColor(d[2])),a.push(new UndoSetForegroundColor(g,h))}else if("SETBACKGROUNDCOLOR"==d[0].toUpperCase())g=parseInt(d[1]),h=this.animatedObjects.backgroundColor(g),this.animatedObjects.setBackgroundColor(g,this.parseColor(d[2])),a.push(new UndoSetBackgroundColor(g,h));else if("SETHIGHLIGHT"==d[0].toUpperCase()){var i=this.parseBool(d[2]);this.animatedObjects.setHighlight(parseInt(d[1]),i),a.push(new UndoHighlight(parseInt(d[1]),!i))}else if("DISCONNECT"==d[0].toUpperCase()){var j=this.animatedObjects.disconnect(parseInt(d[1]),parseInt(d[2]));null!=j&&a.push(j)}else if("SETALPHA"==d[0].toUpperCase()){var k=this.animatedObjects.getAlpha(parseInt(d[1]));this.animatedObjects.setAlpha(parseInt(d[1]),parseFloat(d[2])),a.push(new UndoSetAlpha(parseInt(d[1]),k))}else if("SETTEXT"==d[0].toUpperCase())if(d.length>3){var l=this.animatedObjects.getText(parseInt(d[1]),parseInt(d[3]));this.animatedObjects.setText(parseInt(d[1]),d[2],parseInt(d[3])),void 0!=l&&a.push(new UndoSetText(parseInt(d[1]),l,parseInt(d[3])))}else l=this.animatedObjects.getText(parseInt(d[1]),0),this.animatedObjects.setText(parseInt(d[1]),d[2],0),void 0!=l&&a.push(new UndoSetText(parseInt(d[1]),l,0));else if("DELETE"==d[0].toUpperCase()){var e=parseInt(d[1]),n=this.animatedObjects.deleteIncident(e);n.length>0&&(a=a.concat(n));var o=this.animatedObjects.getObject(e);null!=o&&(a.push(o.createUndoDelete()),this.animatedObjects.removeObject(e))}else if("CREATEHIGHLIGHTCIRCLE"==d[0].toUpperCase())d.length>5?this.animatedObjects.addHighlightCircleObject(parseInt(d[1]),this.parseColor(d[2]),parseFloat(d[5])):this.animatedObjects.addHighlightCircleObject(parseInt(d[1]),this.parseColor(d[2]),20),d.length>4&&this.animatedObjects.setNodePosition(parseInt(d[1]),parseInt(d[3]),parseInt(d[4])),a.push(new UndoCreate(parseInt(d[1])));else if("CREATELABEL"==d[0].toUpperCase())6==d.length?this.animatedObjects.addLabelObject(parseInt(d[1]),d[2],this.parseBool(d[5])):this.animatedObjects.addLabelObject(parseInt(d[1]),d[2],!0),d.length>=5&&this.animatedObjects.setNodePosition(parseInt(d[1]),parseFloat(d[3]),parseFloat(d[4])),a.push(new UndoCreate(parseInt(d[1])));else if("SETEDGECOLOR"==d[0].toUpperCase()){var p=parseInt(d[1]),q=parseInt(d[2]),r=this.parseColor(d[3]),h=this.animatedObjects.setEdgeColor(p,q,r);a.push(new UndoSetEdgeColor(p,q,h))}else if("SETEDGEALPHA"==d[0].toUpperCase()){var p=parseInt(d[1]),q=parseInt(d[2]),s=parseFloat(d[3]),t=this.animatedObjects.setEdgeAlpha(p,q,s);a.push(new UndoSetEdgeAlpha(p,q,t))}else if("SETEDGEHIGHLIGHT"==d[0].toUpperCase()){var i=this.parseBool(d[3]),p=parseInt(d[1]),q=parseInt(d[2]),u=this.animatedObjects.setEdgeHighlight(p,q,i);a.push(new UndoHighlightEdge(p,q,u))}else if("SETHEIGHT"==d[0].toUpperCase()){g=parseInt(d[1]);var v=this.animatedObjects.getHeight(g);this.animatedObjects.setHeight(g,parseInt(d[2])),a.push(new UndoSetHeight(g,v))}else if("SETLAYER"==d[0].toUpperCase())this.animatedObjects.setLayer(parseInt(d[1]),parseInt(d[2]));else if("CREATELINKEDLIST"==d[0].toUpperCase())11==d.length?this.animatedObjects.addLinkedListObject(parseInt(d[1]),d[2],parseInt(d[3]),parseInt(d[4]),parseFloat(d[7]),this.parseBool(d[8]),this.parseBool(d[9]),parseInt(d[10]),"#FFFFFF","#000000"):this.animatedObjects.addLinkedListObject(parseInt(d[1]),d[2],parseInt(d[3]),parseInt(d[4]),.25,!0,!1,1,"#FFFFFF","#000000"),d.length>6&&(this.animatedObjects.setNodePosition(parseInt(d[1]),parseInt(d[5]),parseInt(d[6])),a.push(new UndoCreate(parseInt(d[1]))));else if("SETNULL"==d[0].toUpperCase()){var w=this.animatedObjects.getNull(parseInt(d[1]));this.animatedObjects.setNull(parseInt(d[1]),this.parseBool(d[2])),a.push(new UndoSetNull(parseInt(d[1]),w))}else if("SETTEXTCOLOR"==d[0].toUpperCase())d.length>3?(h=this.animatedObjects.getTextColor(parseInt(d[1]),parseInt(d[3])),this.animatedObjects.setTextColor(parseInt(d[1]),this.parseColor(d[2]),parseInt(d[3])),a.push(new UndoSetTextColor(parseInt(d[1]),h,parseInt(d[3])))):(h=this.animatedObjects.getTextColor(parseInt(d[1]),0),this.animatedObjects.setTextColor(parseInt(d[1]),this.parseColor(d[2]),0),a.push(new UndoSetTextColor(parseInt(d[1]),h,0)));else if("CREATEBTREENODE"==d[0].toUpperCase())this.animatedObjects.addBTreeNode(parseInt(d[1]),parseFloat(d[2]),parseFloat(d[3]),parseInt(d[4]),this.parseColor(d[7]),this.parseColor(d[8])),this.animatedObjects.setNodePosition(parseInt(d[1]),parseInt(d[5]),parseInt(d[6])),a.push(new UndoCreate(parseInt(d[1])));else if("SETWIDTH"==d[0].toUpperCase()){var g=parseInt(d[1]);this.animatedObjects.setWidth(g,parseInt(d[2]));var x=this.animatedObjects.getWidth(g);a.push(new UndoSetWidth(g,x))}else if("SETNUMELEMENTS"==d[0].toUpperCase()){var y=this.animatedObjects.getObject(parseInt(d[1]));a.push(new UndoSetNumElements(y,parseInt(d[2]))),this.animatedObjects.setNumElements(parseInt(d[1]),parseInt(d[2]))}else if("SETPOSITION"==d[0].toUpperCase()){var g=parseInt(d[1]),z=this.animatedObjects.getNodeX(g),A=this.animatedObjects.getNodeY(g);a.push(new UndoSetPosition(g,z,A)),this.animatedObjects.setNodePosition(g,parseInt(d[2]),parseInt(d[3]))}else if("ALIGNRIGHT"==d[0].toUpperCase()){var g=parseInt(d[1]),z=this.animatedObjects.getNodeX(g),A=this.animatedObjects.getNodeY(g);a.push(new UndoSetPosition(g,z.oldY)),this.animatedObjects.alignRight(g,parseInt(d[2]))}else if("ALIGNLEFT"==d[0].toUpperCase()){var g=parseInt(d[1]),z=this.animatedObjects.getNodeX(g),A=this.animatedObjects.getNodeY(g);a.push(new UndoSetPosition(g,z.oldY)),this.animatedObjects.alignLeft(g,parseInt(d[2]))}else if("ALIGNTOP"==d[0].toUpperCase()){var g=parseInt(d[1]),z=this.animatedObjects.getNodeX(g),A=this.animatedObjects.getNodeY(g);a.push(new UndoSetPosition(g,z.oldY)),this.animatedObjects.alignTop(g,parseInt(d[2]))}else if("ALIGNBOTTOM"==d[0].toUpperCase()){var g=parseInt(d[1]),z=this.animatedObjects.getNodeX(g),A=this.animatedObjects.getNodeY(g);a.push(new UndoSetPosition(g,z.oldY)),this.animatedObjects.alignBottom(g,parseInt(d[2]))}this.currentAnimation=this.currentAnimation+1}this.currFrame=0,(!c&&this.animationPaused||!c&&this.currentAnimation==this.AnimationSteps.length)&&(this.currFrame=this.animationBlockLength),this.undoStack.push(a)},this.StartNewAnimation=function(a){clearTimeout(timer),null!=this.AnimationSteps&&(this.previousAnimationSteps.push(this.AnimationSteps),this.undoAnimationStepIndicesStack.push(this.undoAnimationStepIndices)),void 0==a||0==a.length?this.AnimationSteps=["Step"]:this.AnimationSteps=a,this.undoAnimationStepIndices=new Array,this.currentAnimation=0,this.startNextBlock(),this.currentlyAnimating=!0,this.fireEvent("AnimationStarted","NoData"),timer=setTimeout("timeout()",30)},this.stepBack=function(){this.awaitingStep&&null!=this.undoStack&&0!=this.undoStack.length?(this.fireEvent("AnimationStarted","NoData"),clearTimeout(timer),this.awaitingStep=!1,this.undoLastBlock(),clearTimeout(timer),timer=setTimeout("timeout()",30)):!this.currentlyAnimating&&this.animationPaused&&null!=this.undoAnimationStepIndices&&(this.fireEvent("AnimationStarted","NoData"),this.currentlyAnimating=!0,this.undoLastBlock(),clearTimeout(timer),timer=setTimeout("timeout()",30))},this.step=function(){this.awaitingStep&&(this.startNextBlock(),this.fireEvent("AnimationStarted","NoData"),this.currentlyAnimating=!0,clearTimeout(timer),timer=setTimeout("timeout()",30))},this.clearHistory=function(){this.undoStack=[],this.undoAnimationStepIndices=null,this.previousAnimationSteps=[],this.undoAnimationStepIndicesStack=[],this.AnimationSteps=null,this.fireEvent("AnimationUndoUnavailable","NoData"),clearTimeout(timer),this.animatedObjects.update(),this.animatedObjects.draw()},this.skipBack=function(){var a=null!=this.undoAnimationStepIndices&&0!=this.undoAnimationStepIndices.length;if(a){var b;for(b=0;null!=this.currentBlock&&b<this.currentBlock.length;b++){var c=this.currentBlock[b].objectID;this.animatedObjects.setNodePosition(c,this.currentBlock[b].toX,this.currentBlock[b].toY)}for(this.doingUndo&&this.finishUndoBlock(this.undoStack.pop());a;){for(this.undoLastBlock(),b=0;b<this.currentBlock.length;b++)c=this.currentBlock[b].objectID,this.animatedObjects.setNodePosition(c,this.currentBlock[b].toX,this.currentBlock[b].toY);a=this.finishUndoBlock(this.undoStack.pop());
}clearTimeout(timer),this.animatedObjects.update(),this.animatedObjects.draw(),null!=this.undoStack&&0!=this.undoStack.length||this.fireEvent("AnimationUndoUnavailable","NoData")}},this.resetAll=function(){this.clearHistory(),this.animatedObjects.clearAllObjects(),this.animatedObjects.draw(),clearTimeout(timer)},this.skipForward=function(){if(this.currentlyAnimating){for(this.animatedObjects.runFast=!0;null!=this.AnimationSteps&&this.currentAnimation<this.AnimationSteps.length;){var a;for(a=0;null!=this.currentBlock&&a<this.currentBlock.length;a++){var b=this.currentBlock[a].objectID;this.animatedObjects.setNodePosition(b,this.currentBlock[a].toX,this.currentBlock[a].toY)}for(this.doingUndo&&this.finishUndoBlock(this.undoStack.pop()),this.startNextBlock(),a=0;a<this.currentBlock.length;a++){var b=this.currentBlock[a].objectID;this.animatedObjects.setNodePosition(b,this.currentBlock[a].toX,this.currentBlock[a].toY)}}this.animatedObjects.update(),this.currentlyAnimating=!1,this.awaitingStep=!1,this.doingUndo=!1,this.animatedObjects.runFast=!1,this.fireEvent("AnimationEnded","NoData"),clearTimeout(timer),this.animatedObjects.update(),this.animatedObjects.draw()}},this.finishUndoBlock=function(a){for(var b=a.length-1;b>=0;b--)a[b].undoInitialStep(this.animatedObjects);return this.doingUndo=!1,0!=this.undoAnimationStepIndices.length||(this.awaitingStep=!1,this.currentlyAnimating=!1,this.undoAnimationStepIndices=this.undoAnimationStepIndicesStack.pop(),this.AnimationSteps=this.previousAnimationSteps.pop(),this.fireEvent("AnimationEnded","NoData"),this.fireEvent("AnimationUndo","NoData"),this.currentBlock=[],null!=this.undoStack&&0!=this.undoStack.length||(this.currentlyAnimating=!1,this.awaitingStep=!1,this.fireEvent("AnimationUndoUnavailable","NoData")),clearTimeout(timer),this.animatedObjects.update(),this.animatedObjects.draw(),!1)},this.undoLastBlock=function(){if(0!=this.undoAnimationStepIndices.length&&this.undoAnimationStepIndices.length>0){this.doingUndo=!0;var a=!1;this.currentAnimation=this.undoAnimationStepIndices.pop(),this.currentBlock=[];var c,b=this.undoStack[this.undoStack.length-1];for(c=b.length-1;c>=0;c--){var d=b[c].addUndoAnimation(this.currentBlock);a=a||d}this.currFrame=0,!a&&this.animationPaused&&(this.currFrame=this.animationBlockLength),this.currentlyAnimating=!0}},this.setLayer=function(a,b){this.animatedObjects.setLayer(a,b),this.animatedObjects.draw()},this.setAllLayers=function(a){this.animatedObjects.setAllLayers(a),this.animatedObjects.draw()},this.update=function(){if(this.currentlyAnimating){this.currFrame=this.currFrame+1;var a;for(a=0;a<this.currentBlock.length;a++)if(this.currFrame==this.animationBlockLength||1==this.currFrame&&0==this.animationBlockLength)this.animatedObjects.setNodePosition(this.currentBlock[a].objectID,this.currentBlock[a].toX,this.currentBlock[a].toY);else if(this.currFrame<this.animationBlockLength){var b=this.currentBlock[a].objectID;if(this.animatedObjects.existsNode(b)){var c=1/(this.animationBlockLength-this.currFrame),h=(this.animatedObjects.getNodeX(b),this.animatedObjects.getNodeY(b),this.currentBlock[a].toX,this.currentBlock[a].toY,this.lerp(this.animatedObjects.getNodeX(b),this.currentBlock[a].toX,c)),i=this.lerp(this.animatedObjects.getNodeY(b),this.currentBlock[a].toY,c);this.animatedObjects.setNodePosition(b,h,i)}}this.currFrame>=this.animationBlockLength&&(this.doingUndo?this.finishUndoBlock(this.undoStack.pop())&&(this.awaitingStep=!0,this.fireEvent("AnimationWaiting","NoData")):this.animationPaused&&this.currentAnimation<this.AnimationSteps.length?(this.awaitingStep=!0,this.fireEvent("AnimationWaiting","NoData"),this.currentBlock=[]):this.startNextBlock()),this.animatedObjects.update()}}}function SingleAnimation(a,b,c,d,e){this.objectID=a,this.fromX=b,this.fromY=c,this.toX=d,this.toY=e}Function.prototype.bind=function(){var a=this,b=Array.prototype.slice.call(arguments),c=b.shift();return function(){for(var d=0;d<arguments.length;d++)b.push(arguments[d]);return a.apply(c,b)}},EventListener.prototype.removeListener=function(a,b,c){if(void 0!=this.events[a]){var e,d=null;for(e=0;e<this.events[a].length;e++)if(this.events[a][e].scope==b){d=this.events[a][e];break}if(null!=d)for(e=0;e<d.functions.length;e++)if(d.functions[e]==c)return void d.functions.splice(e,1)}},EventListener.prototype.addListener=function(a,b,c){void 0===this.events[a]&&(this.events[a]=[]);var d,e=null;for(d=0;d<this.events[a].length;d++)if(this.events[a][d].scope==b){e=this.events[a][d];break}for(null===e&&(this.events[a].push({scope:b,functions:[]}),e=this.events[a][this.events[a].length-1]),d=0;d<e.functions.length;d++)if(e.functions[d]==c)return;e.functions.push(c)},EventListener.prototype.fireEvent=function(a,b){if(void 0!==this.events[a])for(var c=0;c<this.events[a].length;c++)for(var d=this.events[a][c],e=d.functions,f=d.scope,g=0;g<e.length;g++){var h=e[g];h.call(f,b)}},UndoBlock.prototype.addUndoAnimation=function(a){return!1},UndoBlock.prototype.undoInitialStep=function(a){},UndoMove.prototype=new UndoBlock,UndoMove.prototype.constructor=UndoMove,UndoMove.prototype.addUndoAnimation=function(a){var b=new SingleAnimation(this.objectID,this.fromX,this.fromY,this.toX,this.toY);return a.push(b),!0},UndoCreate.prototype=new UndoBlock,UndoCreate.prototype.constructor=UndoCreate,UndoCreate.prototype.undoInitialStep=function(a){a.removeObject(this.objectID)},UndoHighlight.prototype=new UndoBlock,UndoHighlight.prototype.constructor=UndoHighlight,UndoHighlight.prototype.undoInitialStep=function(a){a.setHighlight(this.objectID,this.highlightValue)},UndoSetHeight.prototype=new UndoBlock,UndoSetHeight.prototype.constructor=UndoSetHeight,UndoSetHeight.prototype.undoInitialStep=function(a){a.setHeight(this.objectID,this.height)},UndoSetWidth.prototype=new UndoBlock,UndoSetWidth.prototype.constructor=UndoSetWidth,UndoSetWidth.prototype.undoInitialStep=function(a){a.setWidth(this.objectID,this.width)},UndoSetNumElements.prototype=new UndoBlock,UndoSetNumElements.prototype.constructor=UndoSetNumElements,UndoSetNumElements.prototype.undoInitialStep=function(a){if(a.setNumElements(this.objectID,this.sizeBeforeChange),this.sizeBeforeChange>this.sizeAfterChange)for(var b=0;b<this.sizeBeforeChange-this.sizeAfterChange;b++)a.setText(this.objectID,this.labels[b],b+this.sizeAfterChange),a.setTextColor(this.objectID,this.colors[b],b+this.sizeAfterChange)},UndoSetAlpha.prototype=new UndoBlock,UndoSetAlpha.prototype.constructor=UndoSetAlpha,UndoSetAlpha.prototype.undoInitialStep=function(a){a.setAlpha(this.objectID,this.alphaVal)},UndoSetNull.prototype=new UndoBlock,UndoSetNull.prototype.constructor=UndoSetNull,UndoSetNull.prototype.undoInitialStep=function(a){a.setNull(this.objectID,this.nullVal)},UndoSetForegroundColor.prototype=new UndoBlock,UndoSetForegroundColor.prototype.constructor=UndoSetForegroundColor,UndoSetForegroundColor.prototype.undoInitialStep=function(a){a.setForegroundColor(this.objectID,this.color)},UndoSetBackgroundColor.prototype=new UndoBlock,UndoSetBackgroundColor.prototype.constructor=UndoSetBackgroundColor,UndoSetBackgroundColor.prototype.undoInitialStep=function(a){a.setBackgroundColor(this.objectID,this.color)},UndoSetText.prototype=new UndoBlock,UndoSetText.prototype.constructor=UndoSetText,UndoSetText.prototype.undoInitialStep=function(a){a.setText(this.objectID,this.newText,this.labelIndex)},UndoSetTextColor.prototype=new UndoBlock,UndoSetTextColor.prototype.constructor=UndoSetTextColor,UndoSetTextColor.prototype.undoInitialStep=function(a){a.setTextColor(this.objectID,this.color,this.index)},UndoHighlightEdge.prototype=new UndoBlock,UndoHighlightEdge.prototype.constructor=UndoHighlightEdge,UndoHighlightEdge.prototype.undoInitialStep=function(a){a.setEdgeHighlight(this.fromID,this.toID,this.highlightValue)},UndoSetEdgeColor.prototype=new UndoBlock,UndoSetEdgeColor.prototype.constructor=UndoSetEdgeColor,UndoSetEdgeColor.prototype.undoInitialStep=function(a){a.setEdgeColor(this.fromID,this.toID,this.color)},UndoSetEdgeAlpha.prototype=new UndoBlock,UndoSetEdgeAlpha.prototype.constructor=UndoSetEdgeAlpha,UndoSetEdgeAlpha.prototype.undoInitialStep=function(a){a.setEdgeAlpha(this.fromID,this.toID,this.alpha)},UndoSetPosition.prototype=new UndoBlock,UndoSetPosition.prototype.constructor=UndoSetPosition,UndoSetPosition.prototype.undoInitialStep=function(a){a.setNodePosition(this.objectID,this.x,this.y)},AnimatedObject.prototype.init=function(){this.backgroundColor="#FFFFFF",this.foregroundColor="#000000",this.highlighted=!1,this.objectID=-1,this.layer=0,this.addedToScene=!0,this.label="",this.labelColor="#000000",this.alpha=1,this.x=0,this.y=0,this.minHeightDiff=3,this.range=5},AnimatedObject.prototype.alwaysOnTop=!1,AnimatedObject.prototype.setBackgroundColor=function(a){this.backgroundColor=a},AnimatedObject.prototype.setForegroundColor=function(a){this.foregroundColor=a},AnimatedObject.prototype.setNull=function(){},AnimatedObject.prototype.getNull=function(){return!1},AnimatedObject.prototype.setAlpha=function(a){this.alpha=a},AnimatedObject.prototype.getAlpha=function(){return this.alpha},AnimatedObject.prototype.setForegroundColor=function(a){this.foregroundColor=a,this.labelColor=a},AnimatedObject.prototype.getHighlight=function(){return this.highlighted},AnimatedObject.prototype.getWidth=function(){return 0},AnimatedObject.prototype.setHighlight=function(a){this.highlighted=a},AnimatedObject.prototype.centerX=function(){return this.x},AnimatedObject.prototype.setWidth=function(a){},AnimatedObject.prototype.centerY=function(){return this.y},AnimatedObject.prototype.alignLeft=function(a){this.y=a.centerY(),this.y=a.right()+this.getWidth()/2},AnimatedObject.prototype.alignRight=function(a){this.y=a.centerY(),this.y=a.left()-this.getWidth()/2},AnimatedObject.prototype.alignTop=function(a){this.x=a.centerX(),this.y=a.top()-this.getWidth()/2},AnimatedObject.prototype.alignBottom=function(a){this.x=a.centerX(),this.y=a.bottom()+this.getWidth()/2},AnimatedObject.prototype.getClosestCardinalPoint=function(a,b){var c,d,e,f;return a<this.left()?(c=this.left()-a,e=this.left()):a>this.right()?(c=a-this.right(),e=this.right()):(c=0,e=this.centerX()),b<this.top()?(d=this.top()-b,f=this.top()):b>this.bottom()?(d=b-this.bottom(),f=this.bottom()):(d=0,f=this.centerY()),d>c?e=this.centerX():f=this.centerY(),[e,f]},AnimatedObject.prototype.centered=function(){return!1},AnimatedObject.prototype.pulseHighlight=function(a){if(this.highlighted){var b=a/7,c=Math.abs(b%(2*this.range-2)-this.range+1);this.highlightDiff=c+this.minHeightDiff}},AnimatedObject.prototype.getTailPointerAttachPos=function(a,b,c){return[this.x,this.y]},AnimatedObject.prototype.getHeadPointerAttachPos=function(a,b){return[this.x,this.y]},AnimatedObject.prototype.identifier=function(){return this.objectID},AnimatedObject.prototype.getText=function(a){return this.label},AnimatedObject.prototype.getTextColor=function(a){return this.labelColor},AnimatedObject.prototype.setTextColor=function(a,b){this.labelColor=a},AnimatedObject.prototype.setText=function(a,b){this.label=a},AnimatedLabel.prototype=new AnimatedObject,AnimatedLabel.prototype.constructor=AnimatedLabel,AnimatedLabel.prototype.alwaysOnTop=!0,AnimatedLabel.prototype.centered=function(){return this.centering},AnimatedLabel.prototype.draw=function(a){if(this.addedToScene){if(a.globalAlpha=this.alpha,a.font="10px sans-serif",this.centering?(a.textAlign="center",a.textBaseline="middle"):(a.textAlign="left",a.textBaseline="top"),this.highlighted&&(a.strokeStyle="#ffaaaa",a.fillStyle="#ff0000",a.lineWidth=this.highlightDiff,a.strokeText(this.label,this.x,this.y)),a.strokeStyle=this.labelColor,a.fillStyle=this.labelColor,a.lineWidth=1,strList=this.label.split("\n"),1==strList.length)a.fillText(this.label,this.x,this.y);else for(var b=this.centering?(1-strList.length)/2:0,c=0;c<strList.length;c++)a.fillText(strList[c],this.x,this.y+b+12*c);a.closePath()}},AnimatedLabel.prototype.alignLeft=function(a){this.centering?(this.y=a.centerY(),this.x=a.left()-this.textWidth/2):(this.y=a.centerY()-5,this.x=a.left()-this.textWidth)},AnimatedLabel.prototype.alignRight=function(a){this.centering?(this.y=a.centerY(),this.x=a.right()+this.textWidth/2):(this.y=a.centerY()-5,this.x=a.right())},AnimatedLabel.prototype.alignTop=function(a){this.centering?(this.y=a.top()-5,this.x=a.centerX()):(this.y=a.top()-10,this.x=a.centerX()-this.textWidth/2)},AnimatedLabel.prototype.alignBottom=function(a){this.centering?(this.y=a.bottom()+5,this.x=a.centerX()):(this.y=a.bottom(),this.x=a.centerX()-this.textWidth/2)},AnimatedLabel.prototype.getWidth=function(){return this.width},AnimatedLabel.prototype.setHighlight=function(a){this.highlighted=a},AnimatedLabel.prototype.createUndoDelete=function(){return new UndoDeleteLabel(this.objectID,this.label,this.x,this.y,this.centering,this.labelColor,this.layer)},AnimatedLabel.prototype.centerX=function(){return this.centering?this.x:this.x+this.textWidth},AnimatedLabel.prototype.centerY=function(){return this.centering?this.y:this.y+5},AnimatedLabel.prototype.top=function(){return this.centering?this.y-5:this.y},AnimatedLabel.prototype.bottom=function(){return this.centering?this.y+5:this.y+10},AnimatedLabel.prototype.right=function(){return this.centering?this.x+this.textWidth/2:this.x+this.textWidth},AnimatedLabel.prototype.left=function(){return this.centering?this.x-this.textWidth/2:this.x},AnimatedLabel.prototype.getTailPointerAttachPos=function(a,b,c){return this.getClosestCardinalPoint(a,b)},AnimatedLabel.prototype.getHeadPointerAttachPos=function(a,b){return this.getClosestCardinalPoint(a,b)},AnimatedLabel.prototype.setText=function(a,b,c){this.label=a,void 0!=c&&(this.textWidth=c)},UndoDeleteLabel.prototype=new UndoBlock,UndoDeleteLabel.prototype.constructor=UndoDeleteLabel,UndoDeleteLabel.prototype.undoInitialStep=function(a){a.addLabelObject(this.objectID,this.nodeLabel,this.labCentered),a.setNodePosition(this.objectID,this.posX,this.posY),a.setForegroundColor(this.objectID,this.labelColor),a.setLayer(this.objectID,this.layer)};var AnimatedCircle=function(a,b){this.objectID=a,this.label=b,this.radius=20,this.thickness=3,this.x=0,this.y=0,this.alpha=1,this.addedToScene=!0};AnimatedCircle.prototype=new AnimatedObject,AnimatedCircle.prototype.constructor=AnimatedCircle,AnimatedCircle.prototype.getTailPointerAttachPos=function(a,b,c){return this.getHeadPointerAttachPos(a,b)},AnimatedCircle.prototype.getWidth=function(){return 2*this.radius},AnimatedObject.prototype.setWidth=function(a){this.radius=a/2},AnimatedCircle.prototype.getHeadPointerAttachPos=function(a,b){var c=a-this.x,d=b-this.y,e=Math.sqrt(c*c+d*d);return 0==e?[this.x,this.y]:[this.x+c/e*this.radius,this.y+d/e*this.radius]},AnimatedCircle.prototype.draw=function(a){a.globalAlpha=this.alpha,this.highlighted&&(a.fillStyle="#ff0000",a.beginPath(),a.arc(this.x,this.y,this.radius+this.highlightDiff,0,2*Math.PI,!0),a.closePath(),a.fill()),a.fillStyle=this.backgroundColor,a.strokeStyle=this.foregroundColor,a.lineWidth=1,a.beginPath(),a.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),a.closePath(),a.fill(),a.stroke(),a.textAlign="center",a.font="10px sans-serif",a.textBaseline="middle",a.lineWidth=1,a.fillStyle=this.foregroundColor;var b=this.label.split("\n");if(1==b.length)a.fillText(this.label,this.x,this.y);else if(b.length%2==0){var c,d=b.length/2;for(c=0;c<b.length/2;c++)a.fillText(b[d-c-1],this.x,this.y-12*(c+.5)),a.fillText(b[d+c],this.x,this.y+12*(c+.5))}else{var c,d=(b.length-1)/2;for(a.fillText(b[d],this.x,this.y),c=0;c<d;c++)a.fillText(b[d-(c+1)],this.x,this.y-12*(c+1)),a.fillText(b[d+(c+1)],this.x,this.y+12*(c+1))}},AnimatedCircle.prototype.createUndoDelete=function(){return new UndoDeleteCircle(this.objectID,this.label,this.x,this.y,this.foregroundColor,this.backgroundColor,this.layer)},UndoDeleteCircle.prototype=new UndoBlock,UndoDeleteCircle.prototype.constructor=UndoDeleteCircle,UndoDeleteCircle.prototype.undoInitialStep=function(a){a.addCircleObject(this.objectID,this.nodeLabel),a.setNodePosition(this.objectID,this.posX,this.posY),a.setForegroundColor(this.objectID,this.fgColor),a.setBackgroundColor(this.objectID,this.bgColor),a.setLayer(this.objectID,this.layer)},AnimatedRectangle=function(a,b,c,d,e,f,g,h){this.w=c,this.h=d,this.xJustify=e,this.yJustify=f,this.label=b,this.labelColor=h,this.backgroundColor=g,this.foregroundColor=h,this.labelColor=this.foregroundColor,this.highlighted=!1,this.objectID=a,this.nullPointer=!1,this.alpha=1,this.addedToScene=!0},AnimatedRectangle.prototype=new AnimatedObject,AnimatedRectangle.prototype.constructor=AnimatedRectangle,AnimatedRectangle.prototype.setNull=function(a){this.nullPointer=a},AnimatedRectangle.prototype.getNull=function(){return this.nullPointer},AnimatedRectangle.prototype.left=function(){return"left"==this.xJustify?this.x:"center"==this.xJustify?this.x-this.w/2:this.x-this.w},AnimatedRectangle.prototype.centerX=function(){return"center"==this.xJustify?this.x:"left"==this.xJustify?this.x+this.w/2:this.x-this.w/2},AnimatedRectangle.prototype.centerY=function(){return"center"==this.yJustify?this.y:"top"==this.yJustify?this.y+this.h/2:this.y-this.w/2},AnimatedRectangle.prototype.top=function(){return"top"==this.yJustify?this.y:"center"==this.yJustify?this.y-this.h/2:this.y-this.h},AnimatedRectangle.prototype.bottom=function(){return"top"==this.yJustify?this.y+this.h:"center"==this.yJustify?this.y+this.h/2:this.y},AnimatedRectangle.prototype.right=function(){return"left"==this.xJustify?this.x+this.w:"center"==this.xJustify?this.x+this.w/2:this.x},AnimatedRectangle.prototype.getHeadPointerAttachPos=function(a,b){return this.getClosestCardinalPoint(a,b)},AnimatedRectangle.prototype.setWidth=function(a){this.w=a},AnimatedRectangle.prototype.setHeight=function(a){this.h=a},AnimatedRectangle.prototype.getWidth=function(){return this.w},AnimatedRectangle.prototype.getHeight=function(){return this.h},AnimatedRectangle.prototype.draw=function(a){if(this.addedToScene){var b,c,d,e;a.globalAlpha=this.alpha,"left"==this.xJustify?(b=this.x,d=this.x+this.w/2):"center"==this.xJustify?(b=this.x-this.w/2,d=this.x):"right"==this.xJustify&&(b=this.x-this.w,d=this.x-this.w/2),"top"==this.yJustify?(c=this.y,e=this.y+this.h/2):"center"==this.yJustify?(c=this.y-this.h/2,e=this.y):"bottom"==this.yJustify&&(c=this.y-this.h,e=this.y-this.h/2),a.lineWidth=1,this.highlighted&&(a.strokeStyle="#ff0000",a.fillStyle="#ff0000",a.beginPath(),a.moveTo(b-this.highlightDiff,c-this.highlightDiff),a.lineTo(b+this.w+this.highlightDiff,c-this.highlightDiff),a.lineTo(b+this.w+this.highlightDiff,c+this.h+this.highlightDiff),a.lineTo(b-this.highlightDiff,c+this.h+this.highlightDiff),a.lineTo(b-this.highlightDiff,c-this.highlightDiff),a.closePath(),a.stroke(),a.fill()),a.strokeStyle=this.foregroundColor,a.fillStyle=this.backgroundColor,a.beginPath(),a.moveTo(b,c),a.lineTo(b+this.w,c),a.lineTo(b+this.w,c+this.h),a.lineTo(b,c+this.h),a.lineTo(b,c),a.closePath(),a.stroke(),a.fill(),this.nullPointer&&(a.beginPath(),a.moveTo(b,c),a.lineTo(b+this.w,c+this.h),a.closePath(),a.stroke()),a.fillStyle=this.labelColor,a.textAlign="center",a.font="10px sans-serif",a.textBaseline="middle",a.lineWidth=1,a.fillText(this.label,this.x,this.y)}},AnimatedRectangle.prototype.setText=function(a,b){this.label=a},AnimatedRectangle.prototype.createUndoDelete=function(){return new UndoDeleteRectangle(this.objectID,this.label,this.x,this.y,this.w,this.h,this.xJustify,this.yJustify,this.backgroundColor,this.foregroundColor,this.highlighted,this.layer)},AnimatedRectangle.prototype.setHighlight=function(a){this.highlighted=a},UndoDeleteRectangle.prototype=new UndoBlock,UndoDeleteRectangle.prototype.constructor=UndoDeleteRectangle,UndoDeleteRectangle.prototype.undoInitialStep=function(a){a.addRectangleObject(this.objectID,this.nodeLabel,this.width,this.height,this.xJustify,this.yJustify,this.backgroundColor,this.foregroundColor),a.setNodePosition(this.objectID,this.posX,this.posY),a.setLayer(this.objectID,this.layer),a.setHighlight(this.objectID,this.highlighted)},AnimatedLinkedList.prototype=new AnimatedObject,AnimatedLinkedList.prototype.constructor=AnimatedLinkedList,AnimatedLinkedList.superclass=AnimatedObject.prototype,AnimatedLinkedList.prototype.init=function(a,b,c,d,e,f,g,h,i,j){AnimatedLinkedList.superclass.init.call(this),this.w=c,this.h=d,this.backgroundColor=i,this.foregroundColor=j,this.vertical=f,this.linkPositionEnd=g,this.linkPercent=e,this.numLabels=h,this.labels=[],this.labelPosX=[],this.labelPosY=[],this.labelColors=[],this.nullPointer=!1,this.currentHeightDif=6,this.maxHeightDiff=5,this.minHeightDiff=3;for(var k=0;k<this.numLabels;k++)this.labels[k]="",this.labelPosX[k]=0,this.labelPosY[k]=0,this.labelColors[k]=this.foregroundColor;this.labels[0]=b,this.highlighted=!1,this.objectID=a},AnimatedLinkedList.prototype.left=function(){return this.vertical?this.x-this.w/2:this.linkPositionEnd?this.x-this.w*(1-this.linkPercent)/2:this.x-this.w*(this.linkPercent+1)/2},AnimatedLinkedList.prototype.setNull=function(a){this.nullPointer!=a&&(this.nullPointer=a)},AnimatedLinkedList.prototype.getNull=function(){return this.nullPointer},AnimatedLinkedList.prototype.right=function(){return this.vertical?this.x+this.w/2:this.linkPositionEnd?this.x+this.w*(this.linkPercent+1)/2:this.x+this.w*(1-this.linkPercent)/2},AnimatedLinkedList.prototype.top=function(){return this.vertical?this.linkPositionEnd?this.y-this.h*(1-this.linkPercent)/2:this.y-this.h*(1+this.linkPercent)/2:this.y-this.h/2},AnimatedLinkedList.prototype.bottom=function(){return this.vertical?this.linkPositionEnd?this.y+this.h*(1+this.linkPercent)/2:this.y+this.h*(1-this.linkPercent)/2:this.y+this.h/2},AnimatedLinkedList.prototype.resetTextPosition=function(){if(this.vertical){this.labelPosX[0]=this.x,this.labelPosY[0]=this.y+this.h*(1-this.linkPercent)/2*(1/this.numLabels-1);for(var a=1;a<this.numLabels;a++)this.labelPosY[a]=this.labelPosY[a-1]+this.h*(1-this.linkPercent)/this.numLabels,this.labelPosX[a]=this.x}else{this.labelPosY[0]=this.y,this.labelPosX[0]=this.x+this.w*(1-this.linkPercent)/2*(1/this.numLabels-1);for(var a=1;a<this.numLabels;a++)this.labelPosY[a]=this.y,this.labelPosX[a]=this.labelPosX[a-1]+this.w*(1-this.linkPercent)/this.numLabels}},AnimatedLinkedList.prototype.getTailPointerAttachPos=function(a,b,c){return this.vertical&&this.linkPositionEnd?[this.x,this.y+this.h/2]:this.vertical&&!this.linkPositionEnd?[this.x,this.y-this.h/2]:!this.vertical&&this.linkPositionEnd?[this.x+this.w/2,this.y]:[this.x-this.w/2,this.y]},AnimatedLinkedList.prototype.getHeadPointerAttachPos=function(a,b){return this.getClosestCardinalPoint(a,b)},AnimatedLinkedList.prototype.setWidth=function(a){this.w=a,this.resetTextPosition()},AnimatedLinkedList.prototype.setHeight=function(a){this.h=a,this.resetTextPosition()},AnimatedLinkedList.prototype.getWidth=function(){return this.w},AnimatedLinkedList.prototype.getHeight=function(){return this.h},AnimatedLinkedList.prototype.draw=function(a){var b,c;b=this.left(),c=this.top(),this.highlighted&&(a.strokeStyle="#ff0000",a.fillStyle="#ff0000",a.beginPath(),a.moveTo(b-this.highlightDiff,c-this.highlightDiff),a.lineTo(b+this.w+this.highlightDiff,c-this.highlightDiff),a.lineTo(b+this.w+this.highlightDiff,c+this.h+this.highlightDiff),a.lineTo(b-this.highlightDiff,c+this.h+this.highlightDiff),a.lineTo(b-this.highlightDiff,c-this.highlightDiff),a.closePath(),a.stroke(),a.fill()),a.strokeStyle=this.foregroundColor,a.fillStyle=this.backgroundColor,a.beginPath(),a.moveTo(b,c),a.lineTo(b+this.w,c),a.lineTo(b+this.w,c+this.h),a.lineTo(b,c+this.h),a.lineTo(b,c),a.closePath(),a.stroke(),a.fill();var d;if(this.vertical)for(b=this.left(),d=1;d<this.numLabels;d++)c=this.y+this.h*(1-this.linkPercent)*(d/this.numLabels-.5),a.beginPath(),a.moveTo(b,c),a.lineTo(b+this.w,c),a.closePath(),a.stroke();else for(c=this.top(),d=1;d<this.numLabels;d++)b=this.x+this.w*(1-this.linkPercent)*(d/this.numLabels-.5),a.beginPath(),a.moveTo(b,c),a.lineTo(b,c+this.h),a.closePath(),a.stroke();for(this.vertical&&this.linkPositionEnd?(b=this.left(),c=this.bottom()-this.h*this.linkPercent,a.beginPath(),a.moveTo(b+this.w,c),a.lineTo(b,c),this.nullPointer&&a.lineTo(this.startX+this.w,this.bottom()),a.closePath(),a.stroke()):this.vertical&&!this.linkPositionEnd?(b=this.left(),c=this.top()+this.h*this.linkPercent,a.beginPath(),a.moveTo(b+this.w,c),a.lineTo(b,c),this.nullPointer&&a.lineTo(b+this.w,this.top()),a.closePath(),a.stroke()):!this.vertical&&this.linkPositionEnd?(b=this.right()-this.w*this.linkPercent,c=this.top(),a.beginPath(),a.moveTo(b,c+this.h),a.lineTo(b,c),this.nullPointer&&a.lineTo(this.right(),c+this.h),a.closePath(),a.stroke()):(b=this.left()+this.w*this.linkPercent,c=this.top(),a.beginPath(),a.moveTo(b,c+this.h),a.lineTo(b,c),this.nullPointer&&a.lineTo(this.left(),c),a.closePath(),a.stroke()),a.textAlign="center",a.font="10px sans-serif",a.textBaseline="middle",a.lineWidth=1,this.resetTextPosition(),d=0;d<this.numLabels;d++)a.fillStyle=this.labelColors[d],a.fillText(this.labels[d],this.labelPosX[d],this.labelPosY[d])},AnimatedLinkedList.prototype.setTextColor=function(a,b){this.labelColors[b]=a},AnimatedLinkedList.prototype.getTextColor=function(a){return this.labelColors[a]},AnimatedLinkedList.prototype.getText=function(a){return this.labels[a]},AnimatedLinkedList.prototype.setText=function(a,b){this.labels[b]=a,this.resetTextPosition()},AnimatedLinkedList.prototype.createUndoDelete=function(){return new UndoDeleteLinkedList(this.objectID,this.numLabels,this.labels,this.x,this.y,this.w,this.h,this.linkPercent,this.linkPositionEnd,this.vertical,this.labelColors,this.backgroundColor,this.foregroundColor,this.layer,this.nullPointer)},AnimatedLinkedList.prototype.setHighlight=function(a){a!=this.highlighted&&(this.highlighted=a)},UndoDeleteLinkedList.prototype=new UndoBlock,UndoDeleteLinkedList.prototype.constructor=UndoDeleteLinkedList,UndoDeleteLinkedList.prototype.undoInitialStep=function(a){a.addLinkedListObject(this.objectID,this.labels[0],this.width,this.height,this.linkPercent,this.verticalOrentation,this.linkAtEnd,this.numLabels,this.backgroundColor,this.foregroundColor),a.setNodePosition(this.objectID,this.posX,this.posY),a.setLayer(this.objectID,this.layer),a.setNull(this.objectID,this.nullPointer);for(var b=0;b<this.numLabels;b++)a.setText(this.objectID,this.labels[b],b),a.setTextColor(this.objectID,this.labelColors[b],b)};var HighlightCircle=function(a,b,c){this.objectID=a,this.radius=c,this.thickness=4,this.foregroundColor=b,this.x=0,this.y=0,this.alpha=1};HighlightCircle.prototype=new AnimatedObject,HighlightCircle.prototype.constructor=HighlightCircle,HighlightCircle.prototype.draw=function(a){a.globalAlpha=this.alpha,a.strokeStyle=this.foregroundColor,a.lineWidth=this.thickness,a.beginPath(),a.arc(this.x,this.y,this.radius,0,2*Math.PI,!0),a.closePath(),a.stroke()},HighlightCircle.prototype.createUndoDelete=function(){return new UndoDeleteHighlightCircle(this.objectID,this.x,this.y,this.foregroundColor,this.radius,this.layer,this.alpha)},UndoDeleteHighlightCircle.prototype=new UndoBlock,UndoDeleteHighlightCircle.prototype.constructor=UndoDeleteHighlightCircle,UndoDeleteHighlightCircle.prototype.undoInitialStep=function(a){a.addHighlightCircleObject(this.objectID,this.color,this.r),a.setLayer(this.objectID,this.layer),a.setNodePosition(this.objectID,this.x,this.y),a.setAlpha(this.objectID,this.alpha)};var LINE_maxHeightDiff=5,LINE_minHeightDiff=3,LINE_range=LINE_maxHeightDiff-LINE_minHeightDiff+1,LINE_highlightDiff=3;UndoConnect.prototype.undoInitialStep=function(a){this.connect?a.connectEdge(this.fromID,this.toID,this.color,this.curve,this.directed,this.edgeLabel,this.anchorPoint):a.disconnect(this.fromID,this.toID)},UndoConnect.prototype.addUndoAnimation=function(a){return!1},Algorithm.prototype.setCodeAlpha=function(a,b){var c,d;for(c=0;c<a.length;c++)for(d=0;d<a[c].length;d++)this.cmd("SetAlpha",a[c][d],b)},Algorithm.prototype.addCodeToCanvasBase=function(a,b,c,d,e,f){f="undefined"!=typeof f?f:0;var h,i,g=Array(a.length);for(h=0;h<a.length;h++)for(g[h]=new Array(a[h].length),i=0;i<a[h].length;i++)g[h][i]=this.nextIndex++,this.cmd("CreateLabel",g[h][i],a[h][i],b,c+h*d,0),this.cmd("SetForegroundColor",g[h][i],e),this.cmd("SetLayer",g[h][i],f),i>0&&this.cmd("AlignRight",g[h][i],g[h][i-1]);return g},Algorithm.prototype.init=function(a,b,c){this.animationManager=a,a.addListener("AnimationStarted",this,this.disableUI),a.addListener("AnimationEnded",this,this.enableUI),a.addListener("AnimationUndo",this,this.undo),this.canvasWidth=b,this.canvasHeight=c,this.actionHistory=[],this.recordAnimation=!0,this.commands=[]},Algorithm.prototype.sizeChanged=function(a,b){},Algorithm.prototype.implementAction=function(a,b){var c=[a,b];this.actionHistory.push(c);var d=a(b);this.animationManager.StartNewAnimation(d)},Algorithm.prototype.isAllDigits=function(a){for(var b=a.length-1;b>=0;b--)if(a.charAt(b)<"0"||a.charAt(b)>"9")return!1;return!0},Algorithm.prototype.normalizeNumber=function(a,b){return this.isAllDigits(a)&&""!=a?("OOO0000"+a).substr(-b,b):a},Algorithm.prototype.disableUI=function(a){},Algorithm.prototype.enableUI=function(a){},Algorithm.prototype.returnSubmitFloat=function(a,b,c){return void 0!=c&&(a.size=c),function(d){var e=0;return window.event?e=d.keyCode:d.which&&(e=d.which),13!=e?controlKey(e)?void 0:109==e?void 0:(void 0!=c||a.value.length<c)&&e>=48&&e<=57?void 0:(void 0!=c||a.value.length<c)&&190==e&&a.value.indexOf(".")==-1&&void 0:void b()}},Algorithm.prototype.returnSubmit=function(a,b,c,d){return void 0!=c&&(a.size=c),function(e){var f=0;if(window.event?f=e.keyCode:e.which&&(f=e.which),13==f&&null!==b)b();else{if(59==f)return!1;if((void 0!=c&&a.value.length>=c||d&&(f<48||f>57))&&!controlKey(f))return!1}}},Algorithm.prototype.addReturnSubmit=function(a,b){a.onkeydown=this.returnSubmit(a,b,4,!1)},Algorithm.prototype.reset=function(){},Algorithm.prototype.undo=function(a){this.actionHistory.pop(),this.reset();var b=this.actionHistory.length;this.recordAnimation=!1;for(var c=0;c<b;c++)this.actionHistory[c][0](this.actionHistory[c][1]);this.recordAnimation=!0},Algorithm.prototype.clearHistory=function(){this.actionHistory=[]},Algorithm.prototype.cmd=function(){if(this.recordAnimation){var a=arguments[0];for(i=1;i<arguments.length;i++)a=a+"<;>"+String(arguments[i]);this.commands.push(a)}},Graph.prototype=new Algorithm,Graph.prototype.constructor=Graph,Graph.superclass=Algorithm.prototype;var SMALL_ALLLOWED=[[!1,!0,!0,!0,!0,!1,!1,!1],[!0,!1,!0,!0,!1,!0,!0,!1],[!0,!0,!1,!1,!0,!0,!0,!1],[!0,!0,!1,!1,!1,!0,!1,!0],[!0,!1,!0,!1,!1,!1,!0,!0],[!1,!0,!0,!0,!1,!1,!0,!0],[!1,!0,!0,!1,!0,!0,!1,!0],[!1,!1,!1,!0,!0,!0,!0,!1]],SMALL_CURVE=[[0,.001,0,.5,-.5,0,0,0],[0,0,0,.001,0,.001,-.2,0],[0,.001,0,0,0,.2,0,0],[-.5,0,0,0,0,.001,0,.5],[.5,0,0,0,0,0,0,-.5],[0,0,-.2,0,0,0,.001,.001],[0,.2,0,0,0,0,0,0],[0,0,0,-.5,.5,0,0,0]],SMALL_X_POS_LOGICAL=[500,425,575,350,650,425,575,500],SMALL_Y_POS_LOGICAL=[25,125,125,225,225,325,325,425],SMALL_ADJ_MATRIX_X_START=300,SMALL_ADJ_MATRIX_Y_START=40,SMALL_ADJ_MATRIX_WIDTH=30,SMALL_ADJ_MATRIX_HEIGHT=30,SMALL_ADJ_LIST_X_START=200,SMALL_ADJ_LIST_Y_START=30,SMALL_ADJ_LIST_ELEM_WIDTH=50,SMALL_ADJ_LIST_ELEM_HEIGHT=30,SMALL_ADJ_LIST_HEIGHT=36,SMALL_ADJ_LIST_WIDTH=36,SMALL_ADJ_LIST_SPACING=10,VERTEX_INDEX_COLOR="#0000FF",EDGE_COLOR="#000000",SMALL_SIZE=8,HIGHLIGHT_COLOR="#0000FF";Graph.prototype.init=function(a,b,c,d,e){d=void 0==d||d,e=void 0!=e&&e,Graph.superclass.init.call(this,a,b,c),this.nextIndex=0,this.currentLayer=1,this.isDAG=e,this.directed=d,this.addControls(),this.setup_small()},Graph.prototype.addControls=function(a){$("#clearEdgesButton").bind("click",this.clearEdgesCallback.bind(this)),$("#addEdgeButton").bind("click",this.addEdgeCallback.bind(this)),$("#generateEdgesButton").bind("click",this.generateRandomEdges.bind(this))},Graph.prototype.clearEdgesCallback=function(a){this.animationManager.resetAll(),this.setup(),this.printEdges()},Graph.prototype.addEdgeCallback=function(){
var a=$("#fromEdge").val(),b=$("#toEdge").val();if(""===a.trim()||""===b.trim())return void this.showError("Ingrese el nodo inicial y final de la nueva arista.");var c=parseInt(a),d=parseInt(b);return Number.isNaN(c)||Number.isNaN(d)?void this.showError("Los valores deben ser numéricos"):this.isValidNodeId(c)&&this.isValidNodeId(d)?void this.connect(c,d):void this.showError("Los identificadores deben corresponder a un nodo válido.")},Graph.prototype.isValidNodeId=function(a){return a>=0&&a<this.size},Graph.prototype.showError=function(a){$("#error").text(a).css("visibility","visible"),setTimeout(function(){$("#error").css("visibility","hidden")},3e3)},Graph.prototype.printEdges=function(){for(var a="",b=0;b<this.size;b++)for(var c=0;c<this.size;c++)this.adj_matrix[b][c]>0&&(""!=a&&(a+=","),a+=this.directed?"("+b+","+c+")":"{"+b+","+c+"}");$("#edgesList").text(a)},Graph.prototype.isConnected=function(a,b){return this.directed?1==this.adj_matrix[a][b]:1==this.adj_matrix[Math.min(a,b)][Math.max(a,b)]},Graph.prototype.connect=function(a,b){if(this.isConnected(a,b))return void this.showError("Los nodos ya están conectados.");var c;this.directed?(this.adj_matrix[a][b]=1,c=this.adjustCurveForDirectedEdges(this.curve[a][b],this.adj_matrix[a][b]>=0)):(this.adj_matrix[Math.min(a,b)][Math.max(a,b)]=1,c=this.curve[a][b]),this.cmd("Connect",this.circleID[a],this.circleID[b],EDGE_COLOR,c,this.directed?1:0,""),this.executeCommands(),this.printEdges()},Graph.prototype.directedGraphCallback=function(a,b){a!=this.directed&&(this.directed=a,this.animationManager.resetAll(),this.setup())},Graph.prototype.smallGraphCallback=function(a){this.size!=SMALL_SIZE&&(this.animationManager.resetAll(),this.setup_small())},Graph.prototype.newGraphCallback=function(a){this.animationManager.resetAll(),this.setup()},Graph.prototype.graphRepChangedCallback=function(a,b){this.animationManager.setAllLayers([0,a]),this.currentLayer=a},Graph.prototype.recolorGraph=function(){for(var a=0;a<this.size;a++)for(var b=0;b<this.size;b++)this.adj_matrix[a][b]>=0&&this.setEdgeColor(a,b,EDGE_COLOR)},Graph.prototype.highlightEdge=function(a,b,c){this.cmd("SetHighlight",this.adj_list_edges[a][b],c),this.cmd("SetHighlight",this.adj_matrixID[a][b],c),this.cmd("SetEdgeHighlight",this.circleID[a],this.circleID[b],c),this.directed||this.cmd("SetEdgeHighlight",this.circleID[b],this.circleID[a],c)},Graph.prototype.setEdgeColor=function(a,b,c){this.cmd("SetForegroundColor",this.adj_list_edges[a][b],c),this.cmd("SetTextColor",this.adj_matrixID[a][b],c),this.cmd("SetEdgeColor",this.circleID[a],this.circleID[b],c),this.directed||this.cmd("SetEdgeColor",this.circleID[b],this.circleID[a],c)},Graph.prototype.clearEdges=function(){for(var a=0;a<this.size;a++)for(var b=0;b<this.size;b++)this.adj_matrix[a][b]>=0&&this.cmd("Disconnect",this.circleID[a],this.circleID[b])},Graph.prototype.rebuildEdges=function(){this.clearEdges(),this.buildEdges()},Graph.prototype.buildEdges=function(){for(var a=0;a<this.size;a++)for(var b=0;b<this.size;b++)if(this.adj_matrix[a][b]>=0){var c;c=this.showEdgeCosts?String(this.adj_matrix[a][b]):"",this.directed?this.cmd("Connect",this.circleID[a],this.circleID[b],EDGE_COLOR,this.adjustCurveForDirectedEdges(this.curve[a][b],this.adj_matrix[b][a]>=0),1,c):a<b&&this.cmd("Connect",this.circleID[a],this.circleID[b],EDGE_COLOR,this.curve[a][b],0,c)}},Graph.prototype.setup_small=function(){this.allowed=SMALL_ALLLOWED,this.curve=SMALL_CURVE,this.x_pos_logical=SMALL_X_POS_LOGICAL,this.y_pos_logical=SMALL_Y_POS_LOGICAL,this.adj_matrix_x_start=SMALL_ADJ_MATRIX_X_START,this.adj_matrix_y_start=SMALL_ADJ_MATRIX_Y_START,this.adj_matrix_width=SMALL_ADJ_MATRIX_WIDTH,this.adj_matrix_height=SMALL_ADJ_MATRIX_HEIGHT,this.adj_list_x_start=SMALL_ADJ_LIST_X_START,this.adj_list_y_start=SMALL_ADJ_LIST_Y_START,this.adj_list_elem_width=SMALL_ADJ_LIST_ELEM_WIDTH,this.adj_list_elem_height=SMALL_ADJ_LIST_ELEM_HEIGHT,this.adj_list_height=SMALL_ADJ_LIST_HEIGHT,this.adj_list_width=SMALL_ADJ_LIST_WIDTH,this.adj_list_spacing=SMALL_ADJ_LIST_SPACING,this.size=SMALL_SIZE,this.setup()},Graph.prototype.setup_large=function(){this.allowed=LARGE_ALLOWED,this.curve=LARGE_CURVE,this.x_pos_logical=LARGE_X_POS_LOGICAL,this.y_pos_logical=LARGE_Y_POS_LOGICAL,this.adj_matrix_x_start=LARGE_ADJ_MATRIX_X_START,this.adj_matrix_y_start=LARGE_ADJ_MATRIX_Y_START,this.adj_matrix_width=LARGE_ADJ_MATRIX_WIDTH,this.adj_matrix_height=LARGE_ADJ_MATRIX_HEIGHT,this.adj_list_x_start=LARGE_ADJ_LIST_X_START,this.adj_list_y_start=LARGE_ADJ_LIST_Y_START,this.adj_list_elem_width=LARGE_ADJ_LIST_ELEM_WIDTH,this.adj_list_elem_height=LARGE_ADJ_LIST_ELEM_HEIGHT,this.adj_list_height=LARGE_ADJ_LIST_HEIGHT,this.adj_list_width=LARGE_ADJ_LIST_WIDTH,this.adj_list_spacing=LARGE_ADJ_LIST_SPACING,this.size=LARGE_SIZE,this.setup()},Graph.prototype.adjustCurveForDirectedEdges=function(a,b){return!b||Math.abs(a)>.01?a:.1},Graph.prototype.setup=function(){this.commands=new Array,this.circleID=new Array(this.size);for(var a=0;a<this.size;a++)this.circleID[a]=this.nextIndex++,this.cmd("CreateCircle",this.circleID[a],a,this.x_pos_logical[a],this.y_pos_logical[a]),this.cmd("SetTextColor",this.circleID[a],VERTEX_INDEX_COLOR,0),this.cmd("SetLayer",this.circleID[a],1);for(this.adj_matrix=new Array(this.size),this.adj_matrixID=new Array(this.size),a=0;a<this.size;a++)this.adj_matrix[a]=new Array(this.size),this.adj_matrixID[a]=new Array(this.size);this.buildEdges(),this.buildAdjList(),this.buildAdjMatrix(),this.animationManager.setAllLayers([0,this.currentLayer]),this.executeCommands(),this.animationManager.skipForward(),this.animationManager.clearHistory(),this.clearHistory()},Graph.prototype.executeCommands=function(){this.animationManager.StartNewAnimation(this.commands),this.commands=[]},Graph.prototype.resetAll=function(){},Graph.prototype.buildAdjMatrix=function(){this.adj_matrix_index_x=new Array(this.size),this.adj_matrix_index_y=new Array(this.size);for(var a=0;a<this.size;a++){this.adj_matrix_index_x[a]=this.nextIndex++,this.adj_matrix_index_y[a]=this.nextIndex++,this.cmd("CreateLabel",this.adj_matrix_index_x[a],a,this.adj_matrix_x_start+a*this.adj_matrix_width,this.adj_matrix_y_start-this.adj_matrix_height),this.cmd("SetForegroundColor",this.adj_matrix_index_x[a],VERTEX_INDEX_COLOR),this.cmd("CreateLabel",this.adj_matrix_index_y[a],a,this.adj_matrix_x_start-this.adj_matrix_width,this.adj_matrix_y_start+a*this.adj_matrix_height),this.cmd("SetForegroundColor",this.adj_matrix_index_y[a],VERTEX_INDEX_COLOR),this.cmd("SetLayer",this.adj_matrix_index_x[a],3),this.cmd("SetLayer",this.adj_matrix_index_y[a],3);for(var b=0;b<this.size;b++){if(this.adj_matrixID[a][b]=this.nextIndex++,this.adj_matrix[a][b]<0)var c="";else c=String(this.adj_matrix[a][b]);this.cmd("CreateRectangle",this.adj_matrixID[a][b],c,this.adj_matrix_width,this.adj_matrix_height,this.adj_matrix_x_start+b*this.adj_matrix_width,this.adj_matrix_y_start+a*this.adj_matrix_height),this.cmd("SetLayer",this.adj_matrixID[a][b],3)}}},Graph.prototype.removeAdjList=function(){for(var a=0;a<this.size;a++){this.cmd("Delete",this.adj_list_list[a],"RAL1"),this.cmd("Delete",this.adj_list_index[a],"RAL2");for(var b=0;b<this.size;b++)this.adj_matrix[a][b]>0&&this.cmd("Delete",this.adj_list_edges[a][b],"RAL3")}},Graph.prototype.buildAdjList=function(){this.adj_list_index=new Array(this.size),this.adj_list_list=new Array(this.size),this.adj_list_edges=new Array(this.size);for(var a=0;a<this.size;a++){this.adj_list_index[a]=this.nextIndex++,this.adj_list_edges[a]=new Array(this.size),this.adj_list_index[a]=this.nextIndex++,this.adj_list_list[a]=this.nextIndex++,this.cmd("CreateRectangle",this.adj_list_list[a],"",this.adj_list_width,this.adj_list_height,this.adj_list_x_start,this.adj_list_y_start+a*this.adj_list_height),this.cmd("SetLayer",this.adj_list_list[a],2),this.cmd("CreateLabel",this.adj_list_index[a],a,this.adj_list_x_start-this.adj_list_width,this.adj_list_y_start+a*this.adj_list_height),this.cmd("SetForegroundColor",this.adj_list_index[a],VERTEX_INDEX_COLOR),this.cmd("SetLayer",this.adj_list_index[a],2);for(var b=this.adj_list_list[a],c=this.adj_list_x_start+this.adj_list_width+this.adj_list_spacing,d=!1,e=0;e<this.size;e++)this.adj_matrix[a][e]>0&&(d=!0,this.adj_list_edges[a][e]=this.nextIndex++,this.cmd("CreateLinkedList",this.adj_list_edges[a][e],e,this.adj_list_elem_width,this.adj_list_elem_height,c,this.adj_list_y_start+a*this.adj_list_height,.25,0,1,2),this.cmd("SetNull",this.adj_list_edges[a][e],1),this.cmd("SetText",this.adj_list_edges[a][e],this.adj_matrix[a][e],1),this.cmd("SetTextColor",this.adj_list_edges[a][e],VERTEX_INDEX_COLOR,0),this.cmd("SetLayer",this.adj_list_edges[a][e],2),c=c+this.adj_list_elem_width+this.adj_list_spacing,this.cmd("Connect",b,this.adj_list_edges[a][e]),this.cmd("SetNull",b,0),b=this.adj_list_edges[a][e]);d||this.cmd("SetNull",this.adj_list_list[a],1)}},Graph.prototype.reset=function(){},Graph.prototype.disableUI=function(a){$("#algoControlSection input").attr("disabled",!0)},Graph.prototype.enableUI=function(a){$("#algoControlSection input").attr("disabled",!1)},Graph.prototype.generateRandomEdges=function(){this.clearEdges();var a=this.directed?.35:.4;for(i=0;i<this.size;i++)for(var b=0;b<this.size;b++)this.adj_matrix[i][b]=i!=b&&Math.random()<=a?1:-1;this.buildEdges(),this.executeCommands(),this.printEdges()};var AUX_ARRAY_WIDTH=25,AUX_ARRAY_HEIGHT=25,AUX_ARRAY_START_Y=150,VISITED_START_X=175,PARENT_START_X=125,HIGHLIGHT_CIRCLE_COLOR="#000000",BFS_TREE_COLOR="#0000FF",BFS_QUEUE_HEAD_COLOR="#0000FF",BFS_VISITED_COLOR="#DADADA",DEFAULT_BACKGROUND_COLOR="#FFFFFF",QUEUE_START_X=30,QUEUE_START_Y=50,QUEUE_SPACING=30;BFS.prototype=new Graph,BFS.prototype.constructor=BFS,BFS.superclass=Graph.prototype,BFS.prototype.addControls=function(){addLabelToAlgorithmBar("Vértice inicial: "),this.startField=addControlToAlgorithmBar("Text",""),this.startField.onkeydown=this.returnSubmit(this.startField,this.startCallback.bind(this),2,!0),this.startField.size=2,this.startButton=addControlToAlgorithmBar("Button","Ejecutar BFS"),this.startButton.onclick=this.startCallback.bind(this),BFS.superclass.addControls.call(this)},BFS.prototype.init=function(a,b,c){showEdgeCosts=!1,BFS.superclass.init.call(this,a,b,c)},BFS.prototype.setup=function(){BFS.superclass.setup.call(this),this.messageID=new Array,this.commands=new Array,this.visitedID=new Array(this.size),this.visitedIndexID=new Array(this.size),this.parentID=new Array(this.size),this.parentIndexID=new Array(this.size);for(var a=0;a<this.size;a++)this.visitedID[a]=this.nextIndex++,this.visitedIndexID[a]=this.nextIndex++,this.parentID[a]=this.nextIndex++,this.parentIndexID[a]=this.nextIndex++,this.cmd("CreateRectangle",this.visitedID[a],"F",AUX_ARRAY_WIDTH,AUX_ARRAY_HEIGHT,VISITED_START_X,AUX_ARRAY_START_Y+a*AUX_ARRAY_HEIGHT),this.cmd("CreateLabel",this.visitedIndexID[a],a,VISITED_START_X-AUX_ARRAY_WIDTH,AUX_ARRAY_START_Y+a*AUX_ARRAY_HEIGHT),this.cmd("SetForegroundColor",this.visitedIndexID[a],VERTEX_INDEX_COLOR),this.cmd("CreateRectangle",this.parentID[a],"",AUX_ARRAY_WIDTH,AUX_ARRAY_HEIGHT,PARENT_START_X,AUX_ARRAY_START_Y+a*AUX_ARRAY_HEIGHT),this.cmd("CreateLabel",this.parentIndexID[a],a,PARENT_START_X-AUX_ARRAY_WIDTH,AUX_ARRAY_START_Y+a*AUX_ARRAY_HEIGHT),this.cmd("SetForegroundColor",this.parentIndexID[a],VERTEX_INDEX_COLOR);this.cmd("CreateLabel",this.nextIndex++,"Anterior",PARENT_START_X-AUX_ARRAY_WIDTH,AUX_ARRAY_START_Y-1.5*AUX_ARRAY_HEIGHT,0),this.cmd("CreateLabel",this.nextIndex++,"Visitados",VISITED_START_X-AUX_ARRAY_WIDTH,AUX_ARRAY_START_Y-1.5*AUX_ARRAY_HEIGHT,0),this.cmd("CreateLabel",this.nextIndex++,"Cola auxiliar",QUEUE_START_X,QUEUE_START_Y-30,0),animationManager.setAllLayers([0,this.currentLayer]),this.executeCommands(),animationManager.skipForward(),animationManager.clearHistory(),this.highlightCircleL=this.nextIndex++,this.highlightCircleAL=this.nextIndex++,this.highlightCircleAM=this.nextIndex++},BFS.prototype.startCallback=function(a){""!=this.startField.value&&(startvalue=this.startField.value,this.startField.value="",parseInt(startvalue)<this.size&&this.implementAction(this.doBFS.bind(this),startvalue))},BFS.prototype.doBFS=function(a){this.visited=new Array(this.size),this.commands=new Array,this.queue=new Array(this.size);var b=0,c=0,d=new Array(this.size),e=0,f=parseInt(a);if(null!=this.messageID)for(var g=0;g<this.messageID.length;g++)this.cmd("Delete",this.messageID[g]);for(this.rebuildEdges(),this.messageID=new Array,g=0;g<this.size;g++)f===g?(this.cmd("SetText",this.visitedID[g],"T"),this.cmd("SetText",this.parentID[g],"-"),this.cmd("SetBackgroundColor",this.circleID[g],BFS_VISITED_COLOR)):(this.cmd("SetText",this.visitedID[g],"F"),this.cmd("SetText",this.parentID[g],""),this.cmd("SetBackgroundColor",this.circleID[g],DEFAULT_BACKGROUND_COLOR)),this.visited[g]=!1,d[g]=this.nextIndex++;for(this.visited[f]=!0,this.queue[c]=f,this.cmd("CreateLabel",d[c],f,QUEUE_START_X+e*QUEUE_SPACING,QUEUE_START_Y),e+=1,c=(c+1)%this.size;e>0;){f=this.queue[b],this.cmd("CreateHighlightCircle",this.highlightCircleL,HIGHLIGHT_CIRCLE_COLOR,this.x_pos_logical[f],this.y_pos_logical[f]),this.cmd("SetLayer",this.highlightCircleL,1),this.cmd("CreateHighlightCircle",this.highlightCircleAL,HIGHLIGHT_CIRCLE_COLOR,this.adj_list_x_start-this.adj_list_width,this.adj_list_y_start+f*this.adj_list_height),this.cmd("SetLayer",this.highlightCircleAL,2),this.cmd("CreateHighlightCircle",this.highlightCircleAM,HIGHLIGHT_CIRCLE_COLOR,this.adj_matrix_x_start-this.adj_matrix_width,this.adj_matrix_y_start+f*this.adj_matrix_height),this.cmd("SetLayer",this.highlightCircleAM,3),this.cmd("SetTextColor",d[b],BFS_QUEUE_HEAD_COLOR);for(var h=0;h<this.size;h++)this.adj_matrix[f][h]>0&&(this.highlightEdge(f,h,1),this.cmd("SetHighlight",this.visitedID[h],1),this.cmd("Step"),this.visited[h]?this.highlightEdge(f,h,0):(this.visited[h]=!0,this.cmd("SetText",this.visitedID[h],"T"),this.cmd("SetText",this.parentID[h],f),this.cmd("SetBackgroundColor",this.circleID[h],BFS_VISITED_COLOR),this.highlightEdge(f,h,0),this.cmd("Disconnect",this.circleID[f],this.circleID[h]),this.cmd("Connect",this.circleID[f],this.circleID[h],BFS_TREE_COLOR,this.curve[f][h],1,""),this.queue[c]=h,this.cmd("CreateLabel",d[c],h,QUEUE_START_X+e*QUEUE_SPACING,QUEUE_START_Y),c=(c+1)%this.size,e+=1),this.cmd("SetHighlight",this.visitedID[h],0),this.cmd("Step"));for(this.cmd("Delete",d[b]),b=(b+1)%this.size,e-=1,g=0;g<e;g++){var i=(g+b)%this.size;this.cmd("Move",d[i],QUEUE_START_X+g*QUEUE_SPACING,QUEUE_START_Y)}this.cmd("Delete",this.highlightCircleL),this.cmd("Delete",this.highlightCircleAM),this.cmd("Delete",this.highlightCircleAL)}return this.commands},BFS.prototype.reset=function(){},BFS.prototype.enableUI=function(a){this.startField.disabled=!1,this.startButton.disabled=!1,this.startButton,BFS.superclass.enableUI.call(this,a)},BFS.prototype.disableUI=function(a){this.startField.disabled=!0,this.startButton.disabled=!0,BFS.superclass.disableUI.call(this,a)};var currentAlg,AUX_ARRAY_WIDTH=25,AUX_ARRAY_HEIGHT=25,AUX_ARRAY_START_Y=250,VISITED_START_X=175,PARENT_START_X=125,HIGHLIGHT_CIRCLE_COLOR="#000000",DFS_TREE_COLOR="#0000FF",BFS_QUEUE_HEAD_COLOR="#0000FF",DFS_VISITED_COLOR="#DADADA",DEFAULT_BACKGROUND_COLOR="#FFFFFF",QUEUE_START_X=30,QUEUE_START_Y=50,QUEUE_SPACING=30;DFS.prototype=new Graph,DFS.prototype.constructor=DFS,DFS.superclass=Graph.prototype,DFS.prototype.addControls=function(){addLabelToAlgorithmBar("Vértice inicial: "),this.startField=addControlToAlgorithmBar("Text",""),this.startField.onkeydown=this.returnSubmit(this.startField,this.startCallback.bind(this),2,!0),this.startButton=addControlToAlgorithmBar("Button","Ejecutar DFS"),this.startButton.onclick=this.startCallback.bind(this),DFS.superclass.addControls.call(this)},DFS.prototype.init=function(a,b,c){showEdgeCosts=!1,DFS.superclass.init.call(this,a,b,c)},DFS.prototype.setup=function(){DFS.superclass.setup.call(this),this.messageID=new Array,this.commands=new Array,this.visitedID=new Array(this.size),this.visitedIndexID=new Array(this.size),this.parentID=new Array(this.size),this.parentIndexID=new Array(this.size);for(var a=0;a<this.size;a++)this.visitedID[a]=this.nextIndex++,this.visitedIndexID[a]=this.nextIndex++,this.parentID[a]=this.nextIndex++,this.parentIndexID[a]=this.nextIndex++,this.cmd("CreateRectangle",this.visitedID[a],"F",AUX_ARRAY_WIDTH,AUX_ARRAY_HEIGHT,VISITED_START_X,AUX_ARRAY_START_Y+a*AUX_ARRAY_HEIGHT),this.cmd("CreateLabel",this.visitedIndexID[a],a,VISITED_START_X-AUX_ARRAY_WIDTH,AUX_ARRAY_START_Y+a*AUX_ARRAY_HEIGHT),this.cmd("SetForegroundColor",this.visitedIndexID[a],VERTEX_INDEX_COLOR),this.cmd("CreateRectangle",this.parentID[a],"",AUX_ARRAY_WIDTH,AUX_ARRAY_HEIGHT,PARENT_START_X,AUX_ARRAY_START_Y+a*AUX_ARRAY_HEIGHT),this.cmd("CreateLabel",this.parentIndexID[a],a,PARENT_START_X-AUX_ARRAY_WIDTH,AUX_ARRAY_START_Y+a*AUX_ARRAY_HEIGHT),this.cmd("SetForegroundColor",this.parentIndexID[a],VERTEX_INDEX_COLOR);this.cmd("CreateLabel",this.nextIndex++,"Anterior",PARENT_START_X-AUX_ARRAY_WIDTH,AUX_ARRAY_START_Y-1.5*AUX_ARRAY_HEIGHT,0),this.cmd("CreateLabel",this.nextIndex++,"Visitados",VISITED_START_X-AUX_ARRAY_WIDTH,AUX_ARRAY_START_Y-1.5*AUX_ARRAY_HEIGHT,0),this.animationManager.setAllLayers([0,this.currentLayer]),this.executeCommands(),this.animationManager.skipForward(),this.animationManager.clearHistory(),this.highlightCircleL=this.nextIndex++,this.highlightCircleAL=this.nextIndex++,this.highlightCircleAM=this.nextIndex++},DFS.prototype.startCallback=function(a){""!=this.startField.value&&(startvalue=this.startField.value,this.startField.value="",parseInt(startvalue)<this.size&&this.implementAction(this.doDFS.bind(this),parseInt(startvalue)))},DFS.prototype.doDFS=function(a){if(this.visited=new Array(this.size),this.commands=new Array,null!=this.messageID)for(var b=0;b<this.messageID.length;b++)this.cmd("Delete",this.messageID[b]);for(this.rebuildEdges(),this.messageID=new Array,b=0;b<this.size;b++)this.cmd("SetText",this.visitedID[b],"F"),this.cmd("SetText",this.parentID[b],""),this.cmd("SetBackgroundColor",this.circleID[a],DEFAULT_BACKGROUND_COLOR),this.visited[b]=!1;return this.cmd("CreateHighlightCircle",this.highlightCircleL,HIGHLIGHT_CIRCLE_COLOR,this.x_pos_logical[a],this.y_pos_logical[a]),this.cmd("SetLayer",this.highlightCircleL,1),this.cmd("CreateHighlightCircle",this.highlightCircleAL,HIGHLIGHT_CIRCLE_COLOR,this.adj_list_x_start-this.adj_list_width,this.adj_list_y_start+a*this.adj_list_height),this.cmd("SetLayer",this.highlightCircleAL,2),this.cmd("CreateHighlightCircle",this.highlightCircleAM,HIGHLIGHT_CIRCLE_COLOR,this.adj_matrix_x_start-this.adj_matrix_width,this.adj_matrix_y_start+a*this.adj_matrix_height),this.cmd("SetLayer",this.highlightCircleAM,3),this.messageY=30,this.cmd("SetText",this.parentID[a],"-"),this.dfsVisit(a,10),this.cmd("Delete",this.highlightCircleL),this.cmd("Delete",this.highlightCircleAL),this.cmd("Delete",this.highlightCircleAM),this.commands},DFS.prototype.dfsVisit=function(a,b){var c=this.nextIndex++;if(this.messageID.push(c),this.cmd("CreateLabel",c,"DFS("+String(a)+")",b,this.messageY,0),this.messageY=this.messageY+20,!this.visited[a]){this.visited[a]=!0,this.cmd("SetText",this.visitedID[a],"T"),this.cmd("SetBackgroundColor",this.circleID[a],DFS_VISITED_COLOR),this.cmd("Step");for(var d=0;d<this.size;d++)this.adj_matrix[a][d]>0&&(this.highlightEdge(a,d,1),this.cmd("SetHighlight",this.visitedID[d],1),this.visited[d]&&(c=this.nextIndex,this.cmd("CreateLabel",c,"Vertice "+String(d)+" ya visitado.",b,this.messageY,0)),this.cmd("Step"),this.highlightEdge(a,d,0),this.cmd("SetHighlight",this.visitedID[d],0),this.visited[d]&&this.cmd("Delete",c),this.visited[d]||(this.cmd("Disconnect",this.circleID[a],this.circleID[d]),this.cmd("Connect",this.circleID[a],this.circleID[d],DFS_TREE_COLOR,this.curve[a][d],1,""),this.cmd("Move",this.highlightCircleL,this.x_pos_logical[d],this.y_pos_logical[d]),this.cmd("Move",this.highlightCircleAL,this.adj_list_x_start-this.adj_list_width,this.adj_list_y_start+d*this.adj_list_height),this.cmd("Move",this.highlightCircleAM,this.adj_matrix_x_start-this.adj_matrix_width,this.adj_matrix_y_start+d*this.adj_matrix_height),this.cmd("SetText",this.parentID[d],a),this.cmd("Step"),this.dfsVisit(d,b+20),c=this.nextIndex,this.cmd("CreateLabel",c,"Volviendo del llamado: DFS("+String(d)+")",b+20,this.messageY,0),this.cmd("Move",this.highlightCircleAL,this.adj_list_x_start-this.adj_list_width,this.adj_list_y_start+a*this.adj_list_height),this.cmd("Move",this.highlightCircleL,this.x_pos_logical[a],this.y_pos_logical[a]),this.cmd("Move",this.highlightCircleAM,this.adj_matrix_x_start-this.adj_matrix_width,this.adj_matrix_y_start+a*this.adj_matrix_height),this.cmd("Step"),this.cmd("Delete",c)),this.cmd("Step"))}},DFS.prototype.reset=function(){};var timer,swapped=!1,ANIMATION_SPEED_DEFAULT=70,objectManager,animationManager,canvas,paused=!1,widthEntry,heightEntry,sizeButton;AnimationManager.prototype=new EventListener,AnimationManager.prototype.constructor=AnimationManager;